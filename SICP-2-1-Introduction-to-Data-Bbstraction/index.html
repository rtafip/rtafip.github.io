<!DOCTYPE html><html lang="en-US"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> SICP 2.1 数据抽象导论 · 拖鞋党的拖鞋摊</title><meta name="description" content="SICP 2.1 数据抽象导论 - 拖鞋党"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://en.ors-sro.com/atom.xml" title="拖鞋党的拖鞋摊"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/icon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/rss/" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">SICP 2.1 数据抽象导论</h1><div class="post-info">Feb 19, 2017</div><div class="post-content"><p>翻车到坑里</p>
<a id="more"></a>
<h2 id="笔记"><a href="#笔记" class="headerlink" title="笔记"></a>笔记</h2><p>这一小节主要将数据封装的抽象，类似接口的感觉。</p>
<h2 id="习题"><a href="#习题" class="headerlink" title="习题"></a>习题</h2><h3 id="习题-2-1"><a href="#习题-2-1" class="headerlink" title="习题 2.1"></a>习题 2.1</h3><blockquote>
<p><strong>Exercise 2.1.</strong>  Define a better version of make-rat that handles both positive and negative arguments. Make-ratshould normalize the sign so that if the rational number is positive, both  the numerator and denominator are positive, and if the rational number is negative, only the numerator is negative.</p>
</blockquote>
<p>想要得到最简的表达式需要两个步骤，一个是需要除以最大公约数，第二个是符号处理。</p>
<p>最大公约数很简单，直接用前面小节的程序即可。</p>
<p>接着处理符号，考虑到负负得正，而题目中已经说明如果整个分式是负数，则分子保留负号。</p>
<p>那只需要判断分母符号就可以了。因为分母不可以有负号。</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">gcd</span></span> a b)</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> b <span class="number">0</span>)</span><br><span class="line">      a</span><br><span class="line">      (<span class="name"><span class="builtin-name">gcd</span></span> b (<span class="name"><span class="builtin-name">remainder</span></span> a b))))</span><br><span class="line">    </span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> a b)</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&lt;</span></span> a b)</span><br><span class="line">      a</span><br><span class="line">      (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">-</span></span> a b) b)))</span><br><span class="line">    </span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">nagetive?</span> x)</span><br><span class="line">  (<span class="name"><span class="builtin-name">&lt;</span></span> x <span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">make-rat</span> n d)</span><br><span class="line">  (<span class="name"><span class="builtin-name">define</span></span> g (<span class="name"><span class="builtin-name">gcd</span></span> (<span class="name"><span class="builtin-name">abs</span></span> n) (<span class="name"><span class="builtin-name">abs</span></span> d)))</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">nagetive?</span> d)</span><br><span class="line">      (<span class="name"><span class="builtin-name">cons</span></span> (<span class="name"><span class="builtin-name">-</span></span> (<span class="name"><span class="builtin-name">/</span></span> n g)) (<span class="name"><span class="builtin-name">-</span></span> (<span class="name"><span class="builtin-name">/</span></span> d g)))</span><br><span class="line">      (<span class="name"><span class="builtin-name">cons</span></span> (<span class="name"><span class="builtin-name">/</span></span> n g) (<span class="name"><span class="builtin-name">/</span></span> d g))))</span><br></pre></td></tr></table></figure>
<p>测试</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">make-rat</span> <span class="number">2</span> <span class="number">4</span>)</span><br><span class="line"><span class="comment">;=&gt; (1 . 2)</span></span><br><span class="line">(<span class="name">make-rat</span> <span class="number">2</span> <span class="number">-4</span>)</span><br><span class="line"><span class="comment">;=&gt; (-1 . 2)</span></span><br><span class="line">(<span class="name">make-rat</span> (<span class="name"><span class="builtin-name">-</span></span> <span class="number">2</span>) <span class="number">4</span>)</span><br><span class="line"><span class="comment">;=&gt; (-1 . 2)</span></span><br><span class="line">(<span class="name">make-rat</span> (<span class="name"><span class="builtin-name">-</span></span> <span class="number">2</span>) (<span class="name"><span class="builtin-name">-</span></span> <span class="number">4</span>))</span><br><span class="line"><span class="comment">;=&gt; (1 . 2)</span></span><br></pre></td></tr></table></figure>
<h3 id="习题-2-2"><a href="#习题-2-2" class="headerlink" title="习题 2.2"></a>习题 2.2</h3><blockquote>
<p><strong>Exercise 2.2.</strong>  Consider the problem of representing line segments in a plane. Each segment is represented as a pair of points: a starting point and an ending point. Define a constructor make-segment and selectors start-segment and end-segment that define the representation of segments in terms of points. Furthermore, a point can be represented as a pair of numbers: the <strong>x</strong> coordinate and the <strong>y</strong> coordinate. Accordingly, specify a constructor make-point and selectors x-point and y-point that define this representation. Finally, using your selectors and constructors, define a procedure midpoint-segment that takes a line segment as argument and returns its midpoint (the point whose coordinates are the average of the coordinates of the endpoints). To try your procedures, you’ll need a way to print points:<br><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">print-point</span> p)</span><br><span class="line">  (<span class="name"><span class="builtin-name">newline</span></span>)</span><br><span class="line">  (<span class="name"><span class="builtin-name">display</span></span> <span class="string">"("</span>)</span><br><span class="line">  (<span class="name"><span class="builtin-name">display</span></span> (<span class="name">x-point</span> p))</span><br><span class="line">  (<span class="name"><span class="builtin-name">display</span></span> <span class="string">","</span>)</span><br><span class="line">  (<span class="name"><span class="builtin-name">display</span></span> (<span class="name">y-point</span> p))</span><br><span class="line">  (<span class="name"><span class="builtin-name">display</span></span> <span class="string">")"</span>))</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>点只需要记录 $x$，$y$。</p>
<p>线段只需要记录起点和终点。</p>
<p>直接用 <code>cons</code> 记录即可。</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">make-point</span> x y)</span><br><span class="line">  (<span class="name"><span class="builtin-name">cons</span></span> x y))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">x-point</span> p)</span><br><span class="line">  (<span class="name"><span class="builtin-name">car</span></span> p))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">y-point</span> p)</span><br><span class="line">  (<span class="name"><span class="builtin-name">cdr</span></span> p))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">print-point</span> p)</span><br><span class="line">  (<span class="name"><span class="builtin-name">display</span></span> <span class="string">"("</span>)</span><br><span class="line">  (<span class="name"><span class="builtin-name">display</span></span> (<span class="name">x-point</span> p))</span><br><span class="line">  (<span class="name"><span class="builtin-name">display</span></span> <span class="string">","</span>)</span><br><span class="line">  (<span class="name"><span class="builtin-name">display</span></span> (<span class="name">y-point</span> p))</span><br><span class="line">  (<span class="name"><span class="builtin-name">display</span></span> <span class="string">")"</span>)</span><br><span class="line">  (<span class="name"><span class="builtin-name">newline</span></span>))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">make-segment</span> begin end)</span><br><span class="line">  (<span class="name"><span class="builtin-name">cons</span></span> begin end))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">begin-segment</span> line)</span><br><span class="line">  (<span class="name"><span class="builtin-name">car</span></span> line))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">end-segment</span> line)</span><br><span class="line">  (<span class="name"><span class="builtin-name">cdr</span></span> line))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">mid-point</span> line)</span><br><span class="line">  (<span class="name"><span class="builtin-name">define</span></span> (<span class="name">average</span> x y) (<span class="name"><span class="builtin-name">/</span></span> (<span class="name"><span class="builtin-name">+</span></span> x y) <span class="number">2</span>))</span><br><span class="line">  (<span class="name">make-point</span> (<span class="name">average</span> (<span class="name">x-point</span> (<span class="name">begin-segment</span> line)) (<span class="name">x-point</span> (<span class="name">end-segment</span> line)))</span><br><span class="line">              (<span class="name">average</span> (<span class="name">y-point</span> (<span class="name">begin-segment</span> line)) (<span class="name">y-point</span> (<span class="name">end-segment</span> line)))))</span><br></pre></td></tr></table></figure>
<p>测试</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">print-point</span> (<span class="name">mid-point</span> (<span class="name">make-segment</span> (<span class="name">make-point</span> <span class="number">1</span> <span class="number">1</span>) (<span class="name">make-point</span> <span class="number">2</span> <span class="number">2</span>))))</span><br><span class="line"><span class="comment">;=&gt; (1.5 . 1.5)</span></span><br></pre></td></tr></table></figure>
<h3 id="习题-2-3"><a href="#习题-2-3" class="headerlink" title="习题 2.3"></a>习题 2.3</h3><blockquote>
<p><strong>Exercise 2.3.</strong>  Implement a representation for rectangles in a plane. (Hint: You may want to make use of exercise <a href="https://mitpress.mit.edu/sicp/full-text/book/book-Z-H-14.html#%_thm_2.2" target="_blank" rel="noopener">2.2</a>.) In terms of your constructors and selectors, create procedures that compute the perimeter and the area of a given rectangle. Now implement a different representation for rectangles. Can you design your system with suitable abstraction barriers, so that the same perimeter and area procedures will work using either representation?</p>
</blockquote>
<p>确定一个矩形，只需要对角线上的两点即可。</p>
<p>通过构建抽象屏障（接口）使得实现和抽象分离。这样即使换了矩形的实现方式也不会影响。</p>
<p>这里选择的抽象屏障是矩形的长和宽，也就是无论矩形底层怎么实现，只要实现了长和宽接口就行。</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">make-rectangle</span> p1 p2)</span><br><span class="line">  (<span class="name"><span class="builtin-name">cons</span></span> p1 p2))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">begin-point</span> rect)</span><br><span class="line">  (<span class="name"><span class="builtin-name">car</span></span> rect))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">end-point</span> rect)</span><br><span class="line">  (<span class="name"><span class="builtin-name">cdr</span></span> rect))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">x-length</span> rect)</span><br><span class="line">  (<span class="name"><span class="builtin-name">abs</span></span> (<span class="name"><span class="builtin-name">-</span></span> (<span class="name">y-point</span> (<span class="name">begin-point</span> rect)) (<span class="name">y-point</span> (<span class="name">end-point</span> rect)))))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">y-lenth</span> rect)</span><br><span class="line">  (<span class="name"><span class="builtin-name">abs</span></span> (<span class="name"><span class="builtin-name">-</span></span> (<span class="name">x-point</span> (<span class="name">begin-point</span> rect)) (<span class="name">x-point</span> (<span class="name">end-point</span> rect)))))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">perimeter</span> rect)</span><br><span class="line">  (<span class="name"><span class="builtin-name">*</span></span> <span class="number">2</span> (<span class="name"><span class="builtin-name">+</span></span> (<span class="name">x-lenth</span> rect) (<span class="name">y-length</span> rect))))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">area</span> rect)</span><br><span class="line">  (<span class="name"><span class="builtin-name">*</span></span> (<span class="name">x-lenth</span> rect) (<span class="name">y-length</span> rect)))</span><br></pre></td></tr></table></figure>
<p>测试</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">perimeter</span> (<span class="name">make-rectangle</span> (<span class="name">make-point</span> <span class="number">1</span> <span class="number">2</span>) (<span class="name">make-point</span> <span class="number">2</span> <span class="number">4</span>)))</span><br><span class="line"><span class="comment">; =&gt; 6</span></span><br><span class="line">(<span class="name">area</span> (<span class="name">make-rectangle</span> (<span class="name">make-point</span> <span class="number">1</span> <span class="number">2</span>) (<span class="name">make-point</span> <span class="number">2</span> <span class="number">4</span>)))</span><br><span class="line"><span class="comment">; =&gt; 2</span></span><br></pre></td></tr></table></figure>
<h3 id="习题-2-4"><a href="#习题-2-4" class="headerlink" title="习题 2.4"></a>习题 2.4</h3><blockquote>
<p><strong>Exercise 2.4.</strong>  Here is an alternative procedural representation of pairs. For this representation, verify that <code>(car (cons x y))</code> yields x for any objects x and y.</p>
</blockquote>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">cons</span></span> x y)</span><br><span class="line">  (<span class="name"><span class="builtin-name">lambda</span></span> (m) (<span class="name">m</span> x y)))</span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">car</span></span> z)</span><br><span class="line">  (<span class="name">z</span> (<span class="name"><span class="builtin-name">lambda</span></span> (p q) p)))</span><br></pre></td></tr></table></figure>
<blockquote>
<p>What is the corresponding definition of cdr? (Hint: To verify that this works, make use of the substitution model of section <a href="https://mitpress.mit.edu/sicp/full-text/book/book-Z-H-10.html#%_sec_1.1.5" target="_blank" rel="noopener">1.1.5</a>.)</p>
</blockquote>
<p>按 Applicative-Order 展开即可。</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">car</span></span> any-cons)</span><br><span class="line"></span><br><span class="line">(<span class="name">any-cons</span> (<span class="name"><span class="builtin-name">lambda</span></span> (p q) p))</span><br><span class="line"></span><br><span class="line">((<span class="name"><span class="builtin-name">lambda</span></span> (m) (<span class="name">m</span> x y)) (<span class="name"><span class="builtin-name">lambda</span></span> (p q) p))</span><br><span class="line"></span><br><span class="line">((<span class="name"><span class="builtin-name">lambda</span></span> (p q) p) x y)</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">lambda</span></span> (x y) x)</span><br><span class="line"></span><br><span class="line"><span class="comment">; x</span></span><br></pre></td></tr></table></figure>
<p>观察 <code>(lambda (p q) p)</code> </p>
<p>把 <code>(p q)</code> 视为一个 <code>cons</code> 那么 <code>cdr cons</code> 就是 <code>cdr (p q)</code> </p>
<p>结果是 <code>q</code> ，写成 lambda 表达式</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">cdr</span></span> z)</span><br><span class="line">  (<span class="name">z</span> (<span class="name"><span class="builtin-name">lambda</span></span> (p q) q)))</span><br></pre></td></tr></table></figure>
<h3 id="习题-2-5"><a href="#习题-2-5" class="headerlink" title="习题 2.5"></a>习题 2.5</h3><blockquote>
<p><strong>Exercise 2.5.</strong>  Show that we can represent pairs of nonnegative integers using only numbers and arithmetic operations if we represent the pair $a$ and $b$ as the integer that is the product $2^a$ $3^b$. Give the corresponding definitions of the procedures cons, car, and cdr.</p>
</blockquote>
<p>先写 <code>cons</code> ，根据 $a$ , $b$ 构造数字</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">cons</span></span> a b)</span><br><span class="line">	(<span class="name"><span class="builtin-name">*</span></span> (<span class="name"><span class="builtin-name">expt</span></span> <span class="number">2</span> a)</span><br><span class="line">	   (<span class="name"><span class="builtin-name">expt</span></span> <span class="number">3</span> b)))</span><br></pre></td></tr></table></figure>
<p>因为数字是由 $2^a \cdot 3^b$ 的形式构建的，所以一直除以 2 就能得到有多少个 2 相乘</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">cars</span> x)</span><br><span class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">odd?</span></span> x)</span><br><span class="line">        <span class="number">0</span></span><br><span class="line">        (<span class="name"><span class="builtin-name">+</span></span> <span class="number">1</span> (<span class="name">cars</span> (<span class="name"><span class="builtin-name">/</span></span> x <span class="number">2</span>)))))</span><br></pre></td></tr></table></figure>
<p>类似的</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">cdrs</span> x)</span><br><span class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">not</span></span> (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> x <span class="number">3</span>) <span class="number">0</span>))</span><br><span class="line">        <span class="number">0</span></span><br><span class="line">        (<span class="name"><span class="builtin-name">+</span></span> <span class="number">1</span> (<span class="name">cdrs</span> (<span class="name"><span class="builtin-name">/</span></span> x <span class="number">3</span>)))))</span><br></pre></td></tr></table></figure>
<h3 id="习题-2-6"><a href="#习题-2-6" class="headerlink" title="习题 2.6"></a>习题 2.6</h3><blockquote>
<p><strong>Exercise 2.6.</strong>  In case representing pairs as procedures wasn’t mind-boggling enough, consider that, in a language that can manipulate procedures, we can get by without numbers (at least insofar as nonnegative integers are concerned) by implementing 0 and the operation of adding 1 as</p>
</blockquote>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> zero (<span class="name"><span class="builtin-name">lambda</span></span> (f) (<span class="name"><span class="builtin-name">lambda</span></span> (x) x)))</span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">add-1</span> n)</span><br><span class="line">  (<span class="name"><span class="builtin-name">lambda</span></span> (f) (<span class="name"><span class="builtin-name">lambda</span></span> (x) (<span class="name">f</span> ((<span class="name">n</span> f) x)))))</span><br></pre></td></tr></table></figure>
<blockquote>
<p>This representation is known as <em>Church numerals</em>, after its inventor, Alonzo Church, the logician who invented the $\lambda$ calculus.</p>
<p>Define one and two directly (not in terms of zero and add-1). (Hint: Use substitution to evaluate <code>(add-1 zero)</code>). Give a direct definition of the addition procedure + (not in terms of repeated application of add-1).</p>
</blockquote>
<p>直接代入展开</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">add-1</span> zero)</span><br><span class="line"></span><br><span class="line"><span class="comment">; 为了方便这里先展开 add-1</span></span><br><span class="line">(<span class="name"><span class="builtin-name">lambda</span></span> (f) (<span class="name"><span class="builtin-name">lambda</span></span> (x) (<span class="name">f</span> ((<span class="name">zero</span> f) x))))</span><br><span class="line"></span><br><span class="line"><span class="comment">; 展开 zero 得</span></span><br><span class="line">(<span class="name"><span class="builtin-name">lambda</span></span> (f) (<span class="name"><span class="builtin-name">lambda</span></span> (x) (<span class="name">f</span> (((<span class="name"><span class="builtin-name">lambda</span></span> (f) (<span class="name"><span class="builtin-name">lambda</span></span> (x) x)) f) x))))</span><br><span class="line"></span><br><span class="line"><span class="comment">; 将 zero 中的 f 代入得</span></span><br><span class="line">(<span class="name"><span class="builtin-name">lambda</span></span> (f) (<span class="name"><span class="builtin-name">lambda</span></span> (x) (<span class="name">f</span> ((<span class="name"><span class="builtin-name">lambda</span></span> (x) x) x))))</span><br><span class="line"></span><br><span class="line"><span class="comment">; 将 x 带入得</span></span><br><span class="line">(<span class="name"><span class="builtin-name">lambda</span></span> (f) (<span class="name"><span class="builtin-name">lambda</span></span> (x) (<span class="name">f</span> x)))</span><br></pre></td></tr></table></figure>
<p>所以定义 one 为</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> one (<span class="name"><span class="builtin-name">lambda</span></span> (f) (<span class="name"><span class="builtin-name">lambda</span></span> (x) (<span class="name">f</span> x))))</span><br></pre></td></tr></table></figure>
<p>用类似的方法</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">add-1</span> one)</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">lambda</span></span> (f) (<span class="name"><span class="builtin-name">lambda</span></span> (x) (<span class="name">f</span> ((<span class="name">one</span> f) x))))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">lambda</span></span> (f) (<span class="name"><span class="builtin-name">lambda</span></span> (x) (<span class="name">f</span> (((<span class="name"><span class="builtin-name">lambda</span></span> (f) (<span class="name"><span class="builtin-name">lambda</span></span> (x) (<span class="name">f</span> x))) f) x))))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">lambda</span></span> (f) (<span class="name"><span class="builtin-name">lambda</span></span> (x) (<span class="name">f</span> ((<span class="name"><span class="builtin-name">lambda</span></span> (x) (<span class="name">f</span> x)) x))))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">lambda</span></span> (f) (<span class="name"><span class="builtin-name">lambda</span></span> (x) (<span class="name">f</span> (<span class="name">f</span> x))))</span><br></pre></td></tr></table></figure>
<p>所以定义 two 为</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> two (<span class="name"><span class="builtin-name">lambda</span></span> (f) (<span class="name"><span class="builtin-name">lambda</span></span> (x) (<span class="name">f</span> (<span class="name">f</span> x)))))</span><br></pre></td></tr></table></figure>
<h3 id="习题-2-7"><a href="#习题-2-7" class="headerlink" title="习题 2.7"></a>习题 2.7</h3><blockquote>
<p><strong>Exercise 2.7.</strong>  Alyssa’s program is incomplete because she has not specified the implementation of the interval abstraction. Here is a definition of the interval constructor:</p>
</blockquote>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">make-interval</span> a b) (<span class="name"><span class="builtin-name">cons</span></span> a b))</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Define selectors upper-bound and lower-bound to complete the implementation.</p>
</blockquote>
<p>因为是 <code>cons</code> 结构。所以直接调用 <code>car</code> 和 <code>cdr</code> 即可。</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">upper-bound</span> interval)</span><br><span class="line">  (<span class="name"><span class="builtin-name">cdr</span></span> interval))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">lower-bound</span> interval)</span><br><span class="line">  (<span class="name"><span class="builtin-name">car</span></span> interval))</span><br></pre></td></tr></table></figure>
<h3 id="习题-2-8"><a href="#习题-2-8" class="headerlink" title="习题 2.8"></a>习题 2.8</h3><blockquote>
<p><strong>Exercise 2.8.</strong>  Using reasoning analogous to Alyssa’s, describe how the difference of two intervals may be computed. Define a corresponding subtraction procedure, called sub-interval.</p>
</blockquote>
<p>区间减法最小值为下界减上界</p>
<p>最大值为上界减下界</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">sub-interval</span> x y)</span><br><span class="line">  (<span class="name">make-interval</span> (<span class="name"><span class="builtin-name">-</span></span> (<span class="name">lower-bound</span> x) (<span class="name">upper-bound</span> y))</span><br><span class="line">                 (<span class="name"><span class="builtin-name">-</span></span> (<span class="name">upper-bound</span> x) (<span class="name">lower-bound</span> y))))</span><br></pre></td></tr></table></figure>
<p>还可以用 <code>(add-interval)</code> 实现。</p>
<h3 id="习题-2-9"><a href="#习题-2-9" class="headerlink" title="习题 2.9"></a>习题 2.9</h3><blockquote>
<p><strong>Exercise 2.9.</strong>  The <em>width</em> of an interval is half of the difference between its upper and lower bounds. The width is a measure of the uncertainty of the number specified by the interval. For some arithmetic operations the width of the result of combining two intervals is a function only of the widths of the argument intervals, whereas for others the width of the combination is not a function of the widths of the argument intervals. Show that the width of the sum (or difference) of two intervals is a function only of the widths of the intervals being added (or subtracted). Give examples to show that this is not true for multiplication or division.</p>
</blockquote>
<p>区间 $[2,4]$ 宽度为 $(4-2) \div 2 = 1$</p>
<p>区间 $[4,8]$ 宽度为 $(8-4) \div 2 = 2$</p>
<p>两个区间的乘积为 $[8,32]$ ，宽度为 $(32-8) \div = 12$</p>
<p>区间 $[4,6]$ 宽度为 $(6-4) \div 2 = 1$</p>
<p>区间 $[6,10]$ 宽度为 $(10-6) \div 2 = 2$</p>
<p>两个区间的乘积为 $[24,60]$ ，宽度为 $(60-24) \div 2 = 18$</p>
<p>可见同样的区间长度，一个是 $12$ ，另一个是 $18$ ，不仅仅由原本的区间宽度决定。   </p>
<h3 id="习题-2-10"><a href="#习题-2-10" class="headerlink" title="习题 2.10"></a>习题 2.10</h3><blockquote>
<p><strong>Exercise 2.10.</strong>  Ben Bitdiddle, an expert systems programmer, looks over Alyssa’s shoulder and comments that it is not clear what it means to divide by an interval that spans zero. Modify Alyssa’s code to check for this condition and to signal an error if it occurs.</p>
</blockquote>
<p>区间包含零那么区间异号</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">div-interval</span> x y)</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">or</span></span> (<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">&lt;</span></span> (<span class="name">lower-bound</span> x) <span class="number">0</span>)</span><br><span class="line">               (<span class="name"><span class="builtin-name">&gt;</span></span> (<span class="name">upper-bound</span> x) <span class="number">0</span>))</span><br><span class="line">          (<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">&lt;</span></span> (<span class="name">lower-bound</span> y) <span class="number">0</span>)</span><br><span class="line">               (<span class="name"><span class="builtin-name">&gt;</span></span> (<span class="name">upper-bound</span> y) <span class="number">0</span>)))</span><br><span class="line">      (<span class="name">error</span> <span class="string">"interval span zero"</span>)</span><br><span class="line">      (<span class="name">mul-interval</span> x </span><br><span class="line">                (<span class="name">make-interval</span> (<span class="name"><span class="builtin-name">/</span></span> <span class="number">1.0</span> (<span class="name">upper-bound</span> y))</span><br><span class="line">                               (<span class="name"><span class="builtin-name">/</span></span> <span class="number">1.0</span> (<span class="name">lower-bound</span> y))))))</span><br></pre></td></tr></table></figure>
<h3 id="习题-2-11"><a href="#习题-2-11" class="headerlink" title="习题 2.11"></a>习题 2.11</h3><blockquote>
<p><strong>Exercise 2.11.</strong>  In passing, Ben also cryptically comments: <code></code>By testing the signs of the endpoints of the intervals, it is possible to break mul-interval into nine cases, only one of which requires more than two multiplications.’’ Rewrite this procedure using Ben’s suggestion.</p>
</blockquote>
<p>假设有四个正数 $a$ , $b$ , $c$ , $d$ 组成两个区间 $x(a,b)$ ，$y(c,d)$ 。</p>
<p>理论上有 $ 2 \times 2 \times 2 \times 2 = 16$ 种排列组合。</p>
<p>但是 $(a,-b)$ 和 $(c,-d)$ 的情况不符合区间上界大于下界的要求。</p>
<p>排除这两种组合后有 $3 \times 3 = 9$ 种组合。</p>
<p>按符号分类讨论</p>
<table>
<thead>
<tr>
<th>组合</th>
<th>Max</th>
<th>Min</th>
</tr>
</thead>
<tbody>
<tr>
<td>$(a,b)$ $(c,d)$</td>
<td>$b \cdot d$</td>
<td>$a \cdot c$</td>
</tr>
<tr>
<td>$(-a,b)$ $(c,d)$</td>
<td>$b \cdot d$</td>
<td>$-a \cdot d$</td>
</tr>
<tr>
<td>$(-a,-b)$ $(c,d)$</td>
<td>$-b \cdot c$</td>
<td>$-a \cdot d$</td>
</tr>
<tr>
<td>$(a,b)$ $(-c,d)$</td>
<td>$b \cdot d$</td>
<td>$b \cdot -c$</td>
</tr>
<tr>
<td>$(-a,b)$ $(-c,d)$</td>
<td>$-a \cdot -c$ 或 $b \cdot d$</td>
<td>$-a \cdot -c$ 或 $ b \cdot  d$</td>
</tr>
<tr>
<td>$(-a,-b)$ $(-c,-d)$</td>
<td>$-a \cdot -c$</td>
<td>$-b \cdot -d$</td>
</tr>
<tr>
<td>$(a,b)$ $(-c,-d)$</td>
<td>$a \cdot -d$</td>
<td>$b \cdot -c$</td>
</tr>
<tr>
<td>$(-a,b)$ $(-c,-d)$</td>
<td>$-a \cdot -c$</td>
<td>$b \cdot -c$</td>
</tr>
<tr>
<td>$(-a,-b)$ $(-c,-d)$</td>
<td>$-a \cdot -c$</td>
<td>$-b \cdot -d$</td>
</tr>
</tbody>
</table>
<h3 id="习题-2-12"><a href="#习题-2-12" class="headerlink" title="习题 2.12"></a>习题 2.12</h3><blockquote>
<p><strong>Exercise 2.12.</strong>  Define a constructor make-center-percent that takes a center and a percentage tolerance and produces the desired interval. You must also define a selector percent that produces the percentage tolerance for a given interval. The center selector is the same as the one shown above.</p>
</blockquote>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">make-center-percent</span> c p)</span><br><span class="line">  (<span class="name">make-interval</span> (<span class="name"><span class="builtin-name">*</span></span> c (<span class="name"><span class="builtin-name">-</span></span> <span class="number">1</span> p)) (<span class="name"><span class="builtin-name">*</span></span> c (<span class="name"><span class="builtin-name">+</span></span> <span class="number">1</span> p))))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">percent</span> x)</span><br><span class="line">  (<span class="name"><span class="builtin-name">-</span></span> (<span class="name"><span class="builtin-name">/</span></span> (<span class="name">upper-bound</span> x) (<span class="name">center</span> x)) <span class="number">1</span>))</span><br></pre></td></tr></table></figure>
<h3 id="习题-2-13"><a href="#习题-2-13" class="headerlink" title="习题 2.13"></a>习题 2.13</h3><blockquote>
<p><strong>Exercise 2.13.</strong>  Show that under the assumption of small percentage tolerances there is a simple formula for the approximate percentage tolerance of the product of two intervals in terms of the tolerances of the factors. You may simplify the problem by assuming that all numbers are positive.</p>
</blockquote>
<p>题目要求找出一个估计区间乘法误差的公式。</p>
<p>按题目中的假设有两个区间 $x(c_x,p_x)$ , $y(c_y,p_y)$ ，所有数都是正数。</p>
<p>那么乘法的最大值是 $(c_x + c_x p_x)(c_y + c_y p_y)$</p>
<p>展开为 $c_x c_y + c_x c_y p_y + c_x c_y p_x + c_x c_y p_x p_y$ </p>
<p>提取公因式 $c_x c_y(1 + p_y + p_x + p_x p_y)$ </p>
<p>乘法的最小值是 $(c_x - c_x p_x)(c_y - c_y p_y)$ </p>
<p>展开为 $c_x c_y (1 - p_y - p_x + p_x p_y)$ </p>
<p>跟最大值的式子很像。将两个式子改写为</p>
<p>最大值 $c_x c_y (1 + p_x p_y) + c_x c_y (p_x + p_y)$</p>
<p>最小值 $c_x c_y (1 + p_x p_y)  - c_x c_y (p_x + p_y)$</p>
<p>显然中点为 $c_x c_y (1 + p_x p_y)$ ，宽度为 $c_x c_y (p_x + p_y)$</p>
<p>所以乘法区间的误差为<br>$$<br>\begin{align}<br>\frac {c_x c_y (p_x + p_y)}{c_x c_y(1 + p_x p_y)} = \frac{p_x + p_y}{1 + p_x p_y} \approx p_x + p_y<br>\end{align}<br>$$</p>
<h3 id="习题-2-14"><a href="#习题-2-14" class="headerlink" title="习题 2.14"></a>习题 2.14</h3><blockquote>
<p><strong>Exercise 2.14.</strong>  Demonstrate that Lem is right. Investigate the behavior of the system on a variety of arithmetic expressions. Make some intervals <em>A</em> and <em>B</em>, and use them in computing the expressions <em>A</em>/<em>A</em> and <em>A</em>/<em>B</em>. You will get the most insight by using intervals whose width is a small percentage of the center value. Examine the results of the computation in center-percent form (see exercise <a href="https://mitpress.mit.edu/sicp/full-text/book/book-Z-H-14.html#%_thm_2.12" target="_blank" rel="noopener">2.12</a>).</p>
</blockquote>
<p>显然这种说法是对的</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">par1</span> (<span class="name">make-center-percent</span> <span class="number">5</span> <span class="number">0.01</span>) (<span class="name">make-center-percent</span> <span class="number">10</span> <span class="number">0.01</span>))</span><br><span class="line"><span class="comment">; =&gt; (3.2346534653465353 . 3.4346801346801343)</span></span><br><span class="line">(<span class="name">par2</span> (<span class="name">make-center-percent</span> <span class="number">5</span> <span class="number">0.01</span>) (<span class="name">make-center-percent</span> <span class="number">10</span> <span class="number">0.01</span>))</span><br><span class="line"><span class="comment">; =&gt; (3.3 . 3.3666666666666663)</span></span><br></pre></td></tr></table></figure>
<p>最直接的原因是区间除法 $A / A \ne 1$ 。</p>
<p>所以 $\frac{1}{R_1}$ 通分的时候 $\frac{1}{R_1} \cdot \frac{R_2}{R_2} \ne \frac{R_2}{R_1R_2} $ 。</p>
<p>因此最后的结果会有偏差。</p>
</div></article></div></main><footer><div class="paginator"><a href="/Covariant-and-Contravariant/" class="prev">PREV</a><a href="/Polyglot/" class="next">NEXT</a></div><div class="copyright"><p>© 2014 - 2018 <a href="http://en.ors-sro.com">拖鞋党</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p><p>Hosted by <a href="https://pages.coding.me" style="font-weight: bold; animation: breathe 3s infinite">Coding Pages</a></p></div></footer></div><script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {
    inlineMath: [ ['$','$'], ["\\\(","\\)"] ],
    processEscapes: true
    }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});
</script></body></html>