<!DOCTYPE html><html lang="en-US"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> SICP 1.2 过程及产生的过程 · 拖鞋党的拖鞋摊</title><meta name="description" content="SICP 1.2 过程及产生的过程 - 拖鞋党"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://en.ors-sro.com/atom.xml" title="拖鞋党的拖鞋摊"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/icon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/rss/" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">SICP 1.2 过程及产生的过程</h1><div class="post-info">Dec 11, 2016</div><div class="post-content"><p>填坑</p>
<a id="more"></a>
<h2 id="笔记">笔记</h2><h3 id="递归与迭代">递归与迭代</h3><p>说到递归的时候有两层含义。</p>
<p>一是指语法形式。从语法形式上讲，函数调用自身称为递归。</p>
<p>二是指计算方式。从计算方式上讲，将问题求解一层层地转化为子问题求解的计算方式称为递归。相对应地，从最底层的子问题开始求解，逐渐求得更高层乃至最后问题的计算方式称为迭代。</p>
<p>书中介绍了求阶乘的两种方法。从语法形式上讲都是递归。从计算方式上讲，一个是递归，一个是迭代。</p>
<p>递归的计算通常分为两步。一步是将问题的求解层层深入逐步化为子问题解的组合，也就是递进。下一步是求解子问题的解，组合这些解，层层返回，也就是回归。</p>
<p>迭代的计算只有一步。从最底层的问题开始求解，由底层问题的解得出高层问题的解，一层层叠上去，最终得到问题的解。</p>
<p>递归的计算过程是先展开后收缩，所以线性递归看来的形状像是一个从左到右箭头。</p>
<p>迭代的计算过程是一层层叠上去的，所以迭代看起来的形状像是一个从上到下直桶。</p>
<p>书中提到了尾递归。还提到了有了尾递归，循环结构就只是语法糖。</p>
<p>迭代计算过程的递归称为尾递归。尾递归之所以能够被现在编译器优化为循环是因为没有了回归的过程，也就是每一步的计算结果只与输入（参数）有关，不用考虑解的组合方式，如阶乘解的组合方式是相乘，斐波那契解的组合方式是相加。不考虑后可以丢弃上一步计算产生的结果和环境，防止爆栈。</p>
<p>递归的计算过程问题只分解为一个子问题的求解称为线性递归。</p>
<p>可能是因为这种方式子问题的增长是线性的 = = 。</p>
<p>递归的计算过程问题分解为两个子问题的求解称为树形递归，更确切地说是二叉树型递归。书中斐波那契的求解过程就是一个二叉树的中序遍历过程。</p>
<p>如果问题分解为三个子问题呢？那当然是三叉树啦！</p>
<h3 id="递归转迭代">递归转迭代</h3><p>递归转迭代有一定的通用技巧。对于那些一眼就能看出如何迭代的，最简单的方式是用循环结构写一遍，然后转成递归的语法形式。如果看不出来，还有一条比较有用的技巧。把计算过程用到的所有上一个过程的量放到输入中，也就是参数化。所有计算的状态只需要全部输入就能还原。将迭代的过程转为参数的变化过程，这个过程中，设法保持参数变化，但结果不变。这一点可以参考习题 1.16</p>
<h3 id="复杂度">复杂度</h3><p>衡量复杂度沿用了数学中的阶级比较记号。</p>
<p>$O$ 表示渐近上界，类似于 $\le$ </p>
<p>$\Theta$ 表示夹在中间，类似于 $=$</p>
<p>$\Omega$ 表示渐进下界，类似于 $\ge$</p>
<p>这是大写记号。还有对应的小写记号。</p>
<p>$o$  表示上界，类似于 $&lt;$</p>
<p>$\omega$  表示下界，类似于 $&gt;$ </p>
<p>例如对于 $f(n) = 3n^2 + n$ 有</p>
<p>$f(n) = O(n^2)$</p>
<p>$f(n) = \Theta(n^2)$</p>
<p>$f(n) = \Omega(n^2)$ </p>
<p>$f(n) = o(n^3)$</p>
<p>$f(n) = \omega(n)$</p>
<p>因为 $O$ 表示渐进上界，所以经常用来描述算法最坏情况。</p>
<p>因为 $\Omega$ 表示渐进下界，所以经常用来描述算法最好情况。</p>
<p>而 $\Theta$ 通常用于描述算法的平均情况。</p>
<p>$O$ 会更常用。因为有时只需要知道最坏情况，还有就是 $O$ 打起来方便啊。不支持数学公式的情况下打 $\Theta$ 和 $\Omega$ 还要去找字符。</p>
<p>复杂度可以用于分析时间复杂度和空间复杂度。</p>
<p>时间复杂度是问题求解的步骤次数。</p>
<p>空间复杂度是问题求解的所需要的额外空间。</p>
<p>对于递归，空间复杂度的求解所需要的额外空间主要是记录参数，也就是求递归的深度。 时间复杂度可以考虑使用<a href="https://en.wikipedia.org/wiki/Master_theorem#Inadmissible_equations" target="_blank" rel="noopener">主方法</a>求解。</p>
<h2 id="习题">习题</h2><h3 id="习题_1-9">习题  1.9</h3><blockquote>
<p><strong>Exercise 1.9.</strong>  Each of the following two procedures defines a method for adding two positive integers in terms of the procedures inc, which increments its argument by 1, and dec, which decrements its argument by 1.</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">+</span></span> a b)</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> a <span class="number">0</span>)</span><br><span class="line">      b</span><br><span class="line">      (<span class="name">inc</span> (<span class="name"><span class="builtin-name">+</span></span> (<span class="name">dec</span> a) b))))</span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">+</span></span> a b)</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> a <span class="number">0</span>)</span><br><span class="line">      b</span><br><span class="line">      (<span class="name"><span class="builtin-name">+</span></span> (<span class="name">dec</span> a) (<span class="name">inc</span> b))))</span><br></pre></td></tr></table></figure>
</blockquote>
<p>分别展开就能区分。第一种方法</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">+</span></span> <span class="number">2</span> <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">;;(inc (+ (dec 2) 3))</span></span><br><span class="line"></span><br><span class="line">(<span class="name">inc</span> (<span class="name"><span class="builtin-name">+</span></span> <span class="number">1</span> <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">;;(inc (inc (+ (dec 1) 3)))</span></span><br><span class="line"></span><br><span class="line">(<span class="name">inc</span> (<span class="name">inc</span> (<span class="name"><span class="builtin-name">+</span></span> <span class="number">0</span> <span class="number">3</span>)))</span><br><span class="line"></span><br><span class="line">(<span class="name">inc</span> (<span class="name">inc</span> <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line">(<span class="name">inc</span> <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">5</span></span><br></pre></td></tr></table></figure>
<p>第二种方法</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">+</span></span> <span class="number">2</span> <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">+</span></span> (<span class="name">dec</span> <span class="number">2</span>) (<span class="name">inc</span> <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">;;(+ 1 4)</span></span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">+</span></span> (<span class="name">dec</span> <span class="number">1</span>) (<span class="name">inc</span> <span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">;;(+ 0 5)</span></span><br><span class="line"></span><br><span class="line"><span class="number">5</span></span><br></pre></td></tr></table></figure>
<p>可以看出，第一种方式式子越来越长，整个过程像是一个箭头。而第二种式子式子长度不变，整个过程像是直桶。</p>
<p>第一种是递归的，因为它展开后再收缩，需要记录整个计算链。</p>
<p>第二种是迭代的，因为它没有发生嵌套，只需要记录两个变量。</p>
<h3 id="习题_1-10">习题  1.10</h3><blockquote>
<p><strong>Exercise 1.10.</strong>  The following procedure computes a mathematical function called Ackermann’s function.</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">A</span> x y)</span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">=</span></span> y <span class="number">0</span>) <span class="number">0</span>)</span><br><span class="line">        ((<span class="name"><span class="builtin-name">=</span></span> x <span class="number">0</span>) (<span class="name"><span class="builtin-name">*</span></span> <span class="number">2</span> y))</span><br><span class="line">        ((<span class="name"><span class="builtin-name">=</span></span> y <span class="number">1</span>) <span class="number">2</span>)</span><br><span class="line">        (<span class="name"><span class="builtin-name">else</span></span> (<span class="name">A</span> (<span class="name"><span class="builtin-name">-</span></span> x <span class="number">1</span>)</span><br><span class="line">                 (<span class="name">A</span> x (<span class="name"><span class="builtin-name">-</span></span> y <span class="number">1</span>))))))</span><br></pre></td></tr></table></figure>
<p>What are the values of the following expressions?</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">A</span> <span class="number">1</span> <span class="number">10</span>)</span><br><span class="line">(<span class="name">A</span> <span class="number">2</span> <span class="number">4</span>)</span><br><span class="line">(<span class="name">A</span> <span class="number">3</span> <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p>Consider the following procedures, where A is the procedure defined above:</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">f</span> n) (<span class="name">A</span> <span class="number">0</span> n))</span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">g</span> n) (<span class="name">A</span> <span class="number">1</span> n))</span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">h</span> n) (<span class="name">A</span> <span class="number">2</span> n))</span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">k</span> n) (<span class="name"><span class="builtin-name">*</span></span> <span class="number">5</span> n n))</span><br></pre></td></tr></table></figure>
<p>Give concise mathematical definitions for the functions computed by the procedures $f$, $g$, and $h$ for positive integer values of $n$. For example, <code>(k n)</code> computes $5n^2$.</p>
</blockquote>
<p>将式子带入求值即可。 <code>(A 1 10)</code></p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">A</span> <span class="number">1</span> <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">9</span>))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">8</span>)))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">7</span>))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">6</span>)))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">5</span>))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">4</span>)))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">3</span>))))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">2</span>)))))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">1</span>))))))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">2</span>)))))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">4</span>))))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">8</span>)))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">16</span>))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">32</span>)))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">64</span>))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">128</span>)))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">256</span>))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> <span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">1024</span></span><br></pre></td></tr></table></figure>
<p><code>(A 2 4)</code></p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">A</span> <span class="number">2</span> <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">1</span> (<span class="name">A</span> <span class="number">2</span> <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">1</span> (<span class="name">A</span> <span class="number">1</span> (<span class="name">A</span> <span class="number">2</span> <span class="number">2</span>)))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">1</span> (<span class="name">A</span> <span class="number">1</span> (<span class="name">A</span> <span class="number">1</span> (<span class="name">A</span> <span class="number">2</span> <span class="number">1</span>))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">1</span> (<span class="name">A</span> <span class="number">1</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">2</span>)))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">1</span> (<span class="name">A</span> <span class="number">1</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">1</span>))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">1</span> (<span class="name">A</span> <span class="number">1</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">2</span>)))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">1</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">1</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">3</span>)))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">1</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">2</span>))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">1</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">1</span>)))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">1</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">2</span>))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">1</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">4</span>)))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">1</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">1</span> <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">15</span>))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">14</span>)))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">13</span>))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">12</span>)))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">11</span>))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">10</span>)))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">9</span>))))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">8</span>)))))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">7</span>))))))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">6</span>)))))))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">5</span>))))))))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">4</span>)))))))))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">3</span>))))))))))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">2</span>)))))))))))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">1</span>))))))))))))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">2</span>)))))))))))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">4</span>))))))))))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">8</span>)))))))))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">16</span>))))))))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">32</span>)))))))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">64</span>))))))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">128</span>)))))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span>(<span class="name">A</span> <span class="number">0</span> <span class="number">256</span>))))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">512</span>)))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">1024</span>))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">2048</span>)))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">4096</span>))))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">8192</span>)))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">16384</span>))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> <span class="number">32768</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">65536</span></span><br></pre></td></tr></table></figure>
<p><code>(A 3 3)</code> </p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">A</span> <span class="number">3</span> <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">2</span> (<span class="name">A</span> <span class="number">3</span> <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">2</span> (<span class="name">A</span> <span class="number">2</span> (<span class="name">A</span> <span class="number">3</span> <span class="number">1</span>)))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">2</span> (<span class="name">A</span> <span class="number">2</span> <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">2</span> (<span class="name">A</span> <span class="number">1</span> (<span class="name">A</span> <span class="number">2</span> <span class="number">1</span>)))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">2</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">2</span> (<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> <span class="number">1</span>)))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">2</span> (<span class="name">A</span> <span class="number">0</span> <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">2</span> <span class="number">4</span>)</span><br><span class="line"><span class="comment">;;后面结果为上面 (A 2 4) 的展开</span></span><br><span class="line"><span class="number">65536</span></span><br></pre></td></tr></table></figure>
<p><code>(f n)</code></p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">f</span> n)</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> n)</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">*</span></span> <span class="number">2</span> n)</span><br><span class="line"></span><br><span class="line"><span class="comment">;; 2n</span></span><br></pre></td></tr></table></figure>
<p><code>(g n)</code></p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">g</span> n)</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">1</span> n)</span><br><span class="line"><span class="comment">;; n = 0</span></span><br><span class="line">(<span class="name">A</span> <span class="number">1</span> <span class="number">0</span>)</span><br><span class="line"><span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">;; n = 1</span></span><br><span class="line">(<span class="name">A</span> <span class="number">1</span> <span class="number">1</span>)</span><br><span class="line"><span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">;; else</span></span><br><span class="line">(<span class="name">A</span> <span class="number">1</span> n)</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">0</span> (<span class="name">A</span> <span class="number">1</span> (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">1</span>)))</span><br><span class="line"><span class="comment">;; 每求值一次就多一次 (A 0 。n 就会 - 1</span></span><br><span class="line"><span class="comment">;; 一直到 n = 1 ，也就是有 n - 1 个 (A 0 </span></span><br><span class="line"><span class="comment">;; (A 0 X) 最终会转化为 2*X</span></span><br><span class="line"><span class="comment">;; (A 0 (A 0 (A 0 ....[n - 1 个] (A 1 1))))</span></span><br><span class="line"><span class="comment">;; 2 * 2 * 2 * 2 ... [n - 1 个] (A 1 1)</span></span><br><span class="line"><span class="comment">;; (2 ^ (n - 1)) * (A 1 1)</span></span><br><span class="line"><span class="comment">;; (2 ^ (n - 1)) * 2</span></span><br><span class="line"><span class="comment">;; 2 ^ n</span></span><br></pre></td></tr></table></figure>
<p><code>(h n)</code></p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">h</span> n)</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">2</span> n)</span><br><span class="line"><span class="comment">;; n = 0</span></span><br><span class="line">(<span class="name">A</span> <span class="number">2</span> <span class="number">0</span>)</span><br><span class="line"><span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">;; n = 1</span></span><br><span class="line">(<span class="name">A</span> <span class="number">2</span> <span class="number">1</span>)</span><br><span class="line"><span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">;; else</span></span><br><span class="line">(<span class="name">A</span> <span class="number">2</span> n)</span><br><span class="line"></span><br><span class="line">(<span class="name">A</span> <span class="number">1</span> (<span class="name">A</span> <span class="number">2</span> (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">1</span>)))</span><br><span class="line"><span class="comment">;; (h n) =&gt; (A 2 n)</span></span><br><span class="line"><span class="comment">;; (g n) =&gt; (A 1 n) =&gt; 2 ^ n</span></span><br><span class="line"><span class="comment">;; 2 ^ (A 2 (- n 1)) =&gt; 2 ^ (h (- n 1))</span></span><br></pre></td></tr></table></figure>
<p>所以答案是</p>
<p><code>(A 1 10)</code> 为 $1024$</p>
<p><code>(A 2 4)</code> 为 $65536$</p>
<p><code>(A 3 3)</code> 为 $65536$</p>
<p><code>(f n)</code> 为 $2n$</p>
<p><code>(g n)</code> 为 $2^n$</p>
<p><code>(h n)</code> 为<br>$$<br>h(n) = \begin{cases} 0 ,  &amp;n = 0\\\underbrace{2 ^ {2 ^ {2 ^ {.  ^ {. ^{.  ^ 2 }}}}}}_{n个 2}  &amp; n \ge 1  \end{cases}<br>$$</p>
<h3 id="习题_1-11">习题 1.11</h3><blockquote>
<p><strong>Exercise 1.11.</strong>  A function <strong>f</strong> is defined by the rule that $f(n) = n $ if  $n &lt; 3 $ and $f(n) = f(n-1) + 2f(n-2) + 3f(n-3)$ if $n \ge 3$ . Write a procedure that computes $f$ by means of a recursive process. Write a procedure that computes $f$ by means of an iterative process.</p>
</blockquote>
<p>递归形式的很好写，直接翻译即可。</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">f</span> n)</span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">&lt;</span></span> n <span class="number">3</span>) n)</span><br><span class="line">		((<span class="name"><span class="builtin-name">&gt;=</span></span> n <span class="number">3</span>) (<span class="name"><span class="builtin-name">+</span></span> (<span class="name">f</span> (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">1</span>)) (<span class="name"><span class="builtin-name">*</span></span> <span class="number">2</span> (<span class="name">f</span> (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">2</span>))) (<span class="name"><span class="builtin-name">*</span></span> <span class="number">3</span> (<span class="name">f</span> (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">3</span>)))))))</span><br></pre></td></tr></table></figure>
<p>观察递归的计算过程，分为两步。第一步展开，将递归式展开到有具体数值的分支。第二步计算，一步步计算回去。所以第二步就是想要的迭代。考虑到 $f(n)$ 需要 $f(n-1)$ ，$f(n-2)$ 和 $f(n-3)$ 三个变量，再加上当前计算到了第几个还需要一个变量。所以一共需要四个变量。用 $a$ $b$ $c$ 分别代表 $f(n-1)$  $f(n-2)$  $f(n-3)$ 。根据 $f$ 的定义得。</p>
<p>$a \leftarrow a + 2b + 3c$</p>
<p>$b \leftarrow a$</p>
<p>$c \leftarrow b$</p>
<p>翻译成代码</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">f-iter</span> a b c n)</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&lt;</span></span> n <span class="number">0</span>) </span><br><span class="line">      a</span><br><span class="line">      (<span class="name">f-iter</span> (<span class="name"><span class="builtin-name">+</span></span> a (<span class="name"><span class="builtin-name">*</span></span> <span class="number">2</span> b) (<span class="name"><span class="builtin-name">*</span></span> <span class="number">3</span> c))</span><br><span class="line">              a</span><br><span class="line">              b</span><br><span class="line">              (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">1</span>))))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">f</span> n) (<span class="name">f-iter</span> <span class="number">2</span> <span class="number">1</span> <span class="number">0</span> (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">3</span>)))</span><br></pre></td></tr></table></figure>
<p>但是这样的代码是有问题的。因为没有考虑 $n &lt; 3$ 的情况。考虑到 $n &lt; 3$  的情况应该是这样的</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">f-iter</span> a b c n)</span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">=</span></span> n <span class="number">0</span>) c)</span><br><span class="line">        ((<span class="name"><span class="builtin-name">=</span></span> n <span class="number">1</span>) b)</span><br><span class="line">        ((<span class="name"><span class="builtin-name">=</span></span> n <span class="number">2</span>) a)</span><br><span class="line">        (<span class="name"><span class="builtin-name">else</span></span> (<span class="name">f-iter</span> (<span class="name"><span class="builtin-name">+</span></span> a (<span class="name"><span class="builtin-name">*</span></span> <span class="number">2</span> b) (<span class="name"><span class="builtin-name">*</span></span> <span class="number">3</span> c)) a b (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">1</span>)))))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">f</span> n) (<span class="name">f-iter</span> <span class="number">2</span> <span class="number">1</span> <span class="number">0</span> n))</span><br></pre></td></tr></table></figure>
<p>通过观察规律发现 $c = f(n)$ 所以还可以这么写</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">f-iter</span> a b c n)</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> n <span class="number">0</span>) </span><br><span class="line">      c</span><br><span class="line">      (<span class="name">f-iter</span> (<span class="name"><span class="builtin-name">+</span></span> a (<span class="name"><span class="builtin-name">*</span></span> <span class="number">2</span> b) (<span class="name"><span class="builtin-name">*</span></span> <span class="number">3</span> c))</span><br><span class="line">              a</span><br><span class="line">              b</span><br><span class="line">              (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">1</span>))))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">f</span> n) (<span class="name">f-iter</span> <span class="number">2</span> <span class="number">1</span> <span class="number">0</span> n))</span><br></pre></td></tr></table></figure>
<p>测试</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">f</span> <span class="number">1</span>)</span><br><span class="line"><span class="comment">;; 1</span></span><br><span class="line">(<span class="name">f</span> <span class="number">2</span>)</span><br><span class="line"><span class="comment">;; 2</span></span><br><span class="line">(<span class="name">f</span> <span class="number">3</span>)</span><br><span class="line"><span class="comment">;; 4</span></span><br><span class="line">(<span class="name">f</span> <span class="number">4</span>)</span><br><span class="line"><span class="comment">;; 11</span></span><br><span class="line">(<span class="name">f</span> <span class="number">5</span>)</span><br><span class="line"><span class="comment">;; 25</span></span><br><span class="line">(<span class="name">f</span> <span class="number">10</span>)</span><br><span class="line"><span class="comment">;; 1892</span></span><br></pre></td></tr></table></figure>
<h3 id="习题_1-12">习题 1.12</h3><blockquote>
<p><strong>Exercise 1.12.</strong>  The following pattern of numbers is called <strong>Pascal’s triangle</strong>.</p>
<p>​     1 </p>
<p>​    1 1</p>
<p>   1 2 1</p>
<p>  1 3 3 1</p>
<p>1 4 6 4 1</p>
</blockquote>
<p>规律题目已经说明，假设 <code>(y row col)</code> 表示第 <code>row</code> 行第 <code>col</code> 列的值，则有</p>
<p>$$<br>y(row,col) = \begin{cases} 1, &amp; col = 1\\1 , &amp; col = row\\y(row - 1,col - 1) + y(row - 1,col) , &amp; otherwise\end{cases}<br>$$<br>对应的代码为</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">y</span> row col)</span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">=</span></span> col <span class="number">1</span>) <span class="number">1</span>)</span><br><span class="line">	    ((<span class="name"><span class="builtin-name">=</span></span> col row) <span class="number">1</span>)</span><br><span class="line">	    (<span class="name"><span class="builtin-name">else</span></span> (<span class="name"><span class="builtin-name">+</span></span> (<span class="name">y</span> (<span class="name"><span class="builtin-name">-</span></span> row <span class="number">1</span>) (<span class="name"><span class="builtin-name">-</span></span> col <span class="number">1</span>))</span><br><span class="line">	             (<span class="name">y</span> (<span class="name"><span class="builtin-name">-</span></span> row <span class="number">1</span>) col)))))</span><br></pre></td></tr></table></figure>
<p>测试</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">y</span> <span class="number">1</span> <span class="number">1</span>)</span><br><span class="line"><span class="comment">;; 1</span></span><br><span class="line">(<span class="name">y</span> <span class="number">2</span> <span class="number">1</span>)</span><br><span class="line"><span class="comment">;; 1</span></span><br><span class="line">(<span class="name">y</span> <span class="number">2</span> <span class="number">2</span>)</span><br><span class="line"><span class="comment">;; 1</span></span><br><span class="line">(<span class="name">y</span> <span class="number">3</span> <span class="number">1</span>)</span><br><span class="line"><span class="comment">;; 1</span></span><br><span class="line">(<span class="name">y</span> <span class="number">3</span> <span class="number">2</span>)</span><br><span class="line"><span class="comment">;; 2</span></span><br><span class="line">(<span class="name">y</span> <span class="number">3</span> <span class="number">3</span>)</span><br><span class="line"><span class="comment">;; 1</span></span><br></pre></td></tr></table></figure>
<h3 id="习题_1-13">习题 1.13</h3><blockquote>
<p><strong>Exercise 1.13.</strong>  Prove that $Fib(n)$ is the closest integer to $\phi^n/\sqrt 5$, where $\phi = (1 + \sqrt 5) / 2$. Hint: Let $\psi = (1 - \sqrt 5)/2$. Use induction and the definition of the Fibonacci numbers (see section <a href="https://mitpress.mit.edu/sicp/full-text/book/book-Z-H-11.html#%_sec_1.2.2" target="_blank" rel="noopener">1.2.2</a>) to prove that $Fib(n) = (\phi^n - \psi^n) / \sqrt 5$.</p>
</blockquote>
<p>题目提示先证明 $Fib(n) = (\phi^n - \psi^n) / \sqrt 5$ 。</p>
<p>这里使用最偷懒最耍赖的数学归纳法来证明。</p>
<p>当 $n = 0$ 时 $Fib(0) = (\phi^0 - \psi^0)/\sqrt 5 = 0 / \sqrt 5 = 0$ ，等式成立。</p>
<p>当 $n = 1$ 时<br>$$<br>\begin{aligned}<br>Fib(1)&amp; = (\phi^1 - \psi^ 1) / \sqrt 5<br>\\&amp;= (\phi - \psi) / \sqrt 5<br>\\&amp;= (\frac{(1+ \sqrt5)}{2} - \frac{(1 - \sqrt 5)}{2}) / \sqrt 5<br>\\&amp;= \sqrt5 / \sqrt 5<br>\\&amp;= 1<br>\end{aligned}<br>$$<br>等式成立。</p>
<p>设当 $n = k$ 时， $Fib(k) = (\phi^k - \psi^k) / \sqrt 5$ 成立。</p>
<p>当 $ n = k  + 1$ 时<br>$$<br>\begin{aligned}<br>&amp;Fib(k+1)<br>\\=&amp; Fib(k) + Fib(k - 1)<br>\\=&amp; (\phi^k - \psi^k) / \sqrt{5} + (\phi^{k-1} - \psi^{k-1}) / \sqrt 5<br>\\=&amp; \frac{(\phi^k+\phi^{k-1}) - (\psi^k + \psi^{k-1})} {\sqrt 5}<br>\\=&amp; \frac{\phi^{k+1}(\phi^{-1} + \phi^{-2}) - \psi^{k+1}(\psi^{-1} + \psi^{-2})}{\sqrt 5}<br>\\=&amp; \cfrac{\phi^{k+1}\cfrac{(\phi + 1)}{ \phi^2} - \psi^{k+1}\cfrac{(\psi+1)}{\psi^2}}{\sqrt 5}<br>\\=&amp; \cfrac{\phi^{k+1}\cfrac{\cfrac{1+\sqrt 5}{2} + 1}{(\cfrac{1+\sqrt5}{2})^2} - \psi^{k+1}\cfrac{\cfrac{1 - \sqrt5}{2} + 1}{(\cfrac{1-\sqrt5}{2})^2}}{\sqrt 5}<br>\\=&amp; \cfrac{\phi^{k+1}\cfrac{\cfrac{3+\sqrt 5}{2}}{\cfrac{3+\sqrt 5}{2}} - \psi^{k+1}\cfrac{\cfrac{3-\sqrt 5}{2}}{\cfrac{3-\sqrt 5}{2}}}{\sqrt 5}<br>\\=&amp; \cfrac{\phi^{k+1} - \psi^{k+1}}{\sqrt 5}<br>\end{aligned}<br>$$</p>
<p>证毕。</p>
<p>接着证明 $Fib(n)$ 是最接近 $\phi^n/\sqrt 5$ 的整数。</p>
<p>若要证明 $Fib(n)$ 是最接近 $\phi^n/\sqrt 5$ 的整数，</p>
<p>只需要证明 $|Fib(n) - \phi^n/\sqrt 5| &lt; 1$ </p>
<p>根据上面的结论有<br>$$<br>\begin{aligned}<br>\left|Fib(n) - \frac{\phi^n}{\sqrt 5}\right| &amp;= \left|\frac{\phi^n - \psi^n}{\sqrt 5} - \frac{\phi^n}{\sqrt 5}\right|<br>\\&amp;= \left|-\frac{\psi^n}{\sqrt 5}\right|<br>\\&amp;= \frac{|\psi^n|}{\sqrt5}<br>\\&amp;&lt; \frac{1}{\sqrt 5} \left(\because 0 &lt; \left|\frac{1 - \sqrt 5}{2}\right| &lt; 1 \right)<br>\\&amp;&lt; 1<br>\end{aligned}<br>$$<br>证毕。</p>
<h3 id="习题_1-14">习题 1.14</h3><blockquote>
<p><strong>Exercise 1.14.</strong>  Draw the tree illustrating the process generated by the count-change procedure of section <a href="https://mitpress.mit.edu/sicp/full-text/book/book-Z-H-11.html#%_sec_1.2.2" target="_blank" rel="noopener">1.2.2</a> in making change for 11 cents. What are the orders of growth of the space and number of steps used by this process as the amount to be changed increases?</p>
</blockquote>
<p>先看程序是怎么执行的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">c 11 5</span><br><span class="line">├───c 11 4</span><br><span class="line">│   ├───c 11 3</span><br><span class="line">│   │   ├───c 11 2</span><br><span class="line">│   │   │   ├───c 11 1</span><br><span class="line">│   │   │   │   ├───c 11 0</span><br><span class="line">│   │   │   │   └───c 10 1</span><br><span class="line">│   │   │   │       ├───c 10 0</span><br><span class="line">│   │   │   │       └───c 9 1</span><br><span class="line">│   │   │   │           ├───c 9 0</span><br><span class="line">│   │   │   │           └───c 8 1</span><br><span class="line">│   │   │   │               ├───c 8 0</span><br><span class="line">│   │   │   │               └───c 7 1</span><br><span class="line">│   │   │   │                   ├───c 7 0</span><br><span class="line">│   │   │   │                   └───c 6 1</span><br><span class="line">│   │   │   │                       ├───c 6 0</span><br><span class="line">│   │   │   │                       └───c 5 1</span><br><span class="line">│   │   │   │                           ├───c 5 0</span><br><span class="line">│   │   │   │                           └───c 4 1</span><br><span class="line">│   │   │   │                               ├───c 4 0</span><br><span class="line">│   │   │   │                               └───c 3 1</span><br><span class="line">│   │   │   │                                   ├───c 3 0</span><br><span class="line">│   │   │   │                                   └───c 2 1</span><br><span class="line">│   │   │   │                                       ├───c 2 0</span><br><span class="line">│   │   │   │                                       └───c 1 1</span><br><span class="line">│   │   │   │                                           ├───c 1 0</span><br><span class="line">│   │   │   │                                           └───c 0 1</span><br><span class="line">│   │   │   └───c 6 2</span><br><span class="line">│   │   │       ├───c 6 1</span><br><span class="line">│   │   │       │   ├───c 6 0</span><br><span class="line">│   │   │       │   └───c 5 1</span><br><span class="line">│   │   │       │       ├───c 5 0</span><br><span class="line">│   │   │       │       └───c 4 1</span><br><span class="line">│   │   │       │           ├───c 4 0</span><br><span class="line">│   │   │       │           └───c 3 1</span><br><span class="line">│   │   │       │               ├───c 3 0</span><br><span class="line">│   │   │       │               └───c 2 1</span><br><span class="line">│   │   │       │                   ├───c 2 0</span><br><span class="line">│   │   │       │                   └───c 1 1</span><br><span class="line">│   │   │       │                       ├───c 1 0</span><br><span class="line">│   │   │       │                       └───c 0 1</span><br><span class="line">│   │   │       └───c 1 2</span><br><span class="line">│   │   │           ├───c 1 1</span><br><span class="line">│   │   │           │   ├───c 1 0</span><br><span class="line">│   │   │           │   └───c 0 1</span><br><span class="line">│   │   │           └───c -4 2</span><br><span class="line">│   │   └───c 1 3</span><br><span class="line">│   │       ├───c 1 2</span><br><span class="line">│   │       │   ├───c 1 1</span><br><span class="line">│   │       │   │   ├───c 1 0</span><br><span class="line">│   │       │   │   └───c 0 1</span><br><span class="line">│   │       │   └───c -4 2</span><br><span class="line">│   │       └───c -11 3</span><br><span class="line">│   └───c -14 4</span><br><span class="line">└───c -39 5</span><br></pre></td></tr></table></figure>
<p>接着求时间复杂度和空间复杂度。</p>
<p>空间复杂度是树的最大深度。显然对于换硬币问题，嵌套最深的情况是全部都以最小的零钱兑换。也就是深度是 $change \div 1 = change$  。所以空间复杂度是 $\Theta(change)$ 或者说 $\Theta(n)$ 。</p>
<p>时间复杂度是树的子节点个数。</p>
<p>没算出来= =</p>
<h3 id="习题_1-15">习题 1.15</h3><blockquote>
<p><strong>Exercise 1.15.</strong>  The sine of an angle (specified in radians) can be computed by making use of the approximation $\sin x \approx x$ if x is sufficiently small, and the trigonometric identity<br>$$<br>\sin x = 3 \sin \frac{x}{3} - 4\sin^3 \frac{x}{3}<br>$$<br>to reduce the size of the argument of sin. (For purposes of this exercise an angle is considered “sufficiently small’’ if its magnitude is not greater than 0.1 radians.) These ideas are incorporated in the following procedures:</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">cube</span> x) (<span class="name"><span class="builtin-name">*</span></span> x x x))</span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">p</span> x) (<span class="name"><span class="builtin-name">-</span></span> (<span class="name"><span class="builtin-name">*</span></span> <span class="number">3</span> x) (<span class="name"><span class="builtin-name">*</span></span> <span class="number">4</span> (<span class="name">cube</span> x))))</span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">sine</span> angle)</span><br><span class="line">   (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">not</span></span> (<span class="name"><span class="builtin-name">&gt;</span></span> (<span class="name"><span class="builtin-name">abs</span></span> angle) <span class="number">0.1</span>))</span><br><span class="line">       angle</span><br><span class="line">       (<span class="name">p</span> (<span class="name">sine</span> (<span class="name"><span class="builtin-name">/</span></span> angle <span class="number">3.0</span>)))))</span><br></pre></td></tr></table></figure>
<p>a.  How many times is the procedure <code>p</code> applied when <code>(sine 12.15)</code> is evaluated?</p>
<p>b.  What is the order of growth in space and number of steps (as a function of <strong>a</strong>) used by the process generated by the sine procedure when <code>(sine a)</code> is evaluated?</p>
</blockquote>
<p>执行过程</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">sine</span> <span class="number">12.15</span>)</span><br><span class="line"></span><br><span class="line">(<span class="name">p</span> (<span class="name">sine</span> <span class="number">4.5</span>))</span><br><span class="line"></span><br><span class="line">(<span class="name">p</span> (<span class="name">p</span> (<span class="name">sine</span> <span class="number">1.5</span>)))</span><br><span class="line"></span><br><span class="line">(<span class="name">p</span> (<span class="name">p</span> (<span class="name">p</span> (<span class="name">sine</span> <span class="number">0.5</span>))))</span><br><span class="line"></span><br><span class="line">(<span class="name">p</span> (<span class="name">p</span> (<span class="name">p</span> (<span class="name">p</span> (<span class="name">sine</span> <span class="number">0.1666667</span>)))))</span><br><span class="line"></span><br><span class="line">(<span class="name">p</span> (<span class="name">p</span> (<span class="name">p</span> (<span class="name">p</span> (<span class="name">p</span> (<span class="name">sine</span> <span class="number">0.0555556</span>))))))</span><br><span class="line"></span><br><span class="line">(<span class="name">p</span> (<span class="name">p</span> (<span class="name">p</span> (<span class="name">p</span> (<span class="name">p</span> <span class="number">0.0555556</span>)))))</span><br></pre></td></tr></table></figure>
<p>最后迭代到 <code>(p (p (p (p (p (sine 0.0555556))))))</code> 所以问题 a 的答案是 <code>p</code> 一共被调用了 5 次。</p>
<p>空间复杂度等于树的深度，在这里等于 <code>p</code> 的调用次数 $x$，根据题意有<br>$$<br>\begin{aligned}<br>&amp;angle \div 3^x &lt; 0.1<br>\\&amp; angle &lt; 0.1 \times 3^x<br>\\&amp; 10angle &lt; 3^x<br>\\&amp; \log_3{10angle} &lt; x<br>\end{aligned}<br>$$<br>所以空间复杂度为 $\Theta(\log_3{angle})$ 或者说 $\Theta(\log{n})$ </p>
<p>时间复杂度等于树的节点数，在这里也等于 <code>p</code> 的调用次数，所以时间复杂度为 $\Theta(\log{n})$ 。</p>
<h3 id="习题_1-16">习题 1.16</h3><blockquote>
<p><strong>Exercise 1.16.</strong>  Design a procedure that evolves an iterative exponentiation process that uses successive squaring and uses a logarithmic number of steps, as does <code>fast-expt</code>. (Hint: Using the observation that $ (b^{n/2})^2 = (b^2)^{n/2} $, keep, along with the exponent $n$ and the base $b$, an additional state variable $a$, and define the state transformation in such a way that the product $ab^n$ is unchanged from state to state. At the beginning of the process $a$ is taken to be $1$, and the answer is given by the value of $a$ at the end of the process. In general, the technique of defining an <em>invariant quantity</em> that remains unchanged from state to state is a powerful way to think about the design of iterative algorithms.)</p>
</blockquote>
<p>题目的提示已经说得很清楚了。按照题目的思路做就可以了。题目思路如下</p>
<p>除了底 $b$，幂 $n$ 还需要一个变量 $a$ 来记录累积的值，在迭代中保持 $ab^n$ 不变。也就是</p>
<p>当 $n = 0$ 时，结果为 $ab^n$</p>
<p>当 $n$ 是偶数时 ， $b^n = (b^2)^{n/2}$ ， a 不变 。 此时 $ab^n = a(b^2)^{n/2}$ ，转化为求 $\frac{n}{2}$ 次方。</p>
<p>当 $n$ 是奇数时，$b^n = b \cdot b^{(n-1)}$ ，$ a \leftarrow a \cdot b$ ，此时 $ab^n = b \cdot b^{n-1}$ ，转化为求 $n-1$ 次方</p>
<p>写成代码是</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">square</span> x) (<span class="name"><span class="builtin-name">*</span></span> x x))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">fast-expt-iter</span> b n a)</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> n <span class="number">0</span>)</span><br><span class="line">      a</span><br><span class="line">      (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">even?</span></span> n)</span><br><span class="line">          (<span class="name">fast-expt-iter</span> (<span class="name">square</span> b) (<span class="name"><span class="builtin-name">/</span></span> n <span class="number">2</span>) a)</span><br><span class="line">          (<span class="name">fast-expt-iter</span> b (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">1</span>) (<span class="name"><span class="builtin-name">*</span></span> b a)))))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">fast-expt</span> b n)</span><br><span class="line">  (<span class="name">fast-expt-iter</span> b n <span class="number">1</span>))</span><br></pre></td></tr></table></figure>
<p>测试</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">fast-expt</span> <span class="number">2</span> <span class="number">1</span>)</span><br><span class="line"><span class="comment">;; 2</span></span><br><span class="line">(<span class="name">fast-expt</span> <span class="number">2</span> <span class="number">4</span>)</span><br><span class="line"><span class="comment">;; 16</span></span><br><span class="line">(<span class="name">fast-expt</span> <span class="number">10</span> <span class="number">10</span>)</span><br><span class="line"><span class="comment">;; 10000000000</span></span><br></pre></td></tr></table></figure>
<p>这种找出恒等关系的做法很常用。</p>
<h3 id="习题_1-17">习题 1.17</h3><blockquote>
<p><strong>Exercise 1.17.</strong>  The exponentiation algorithms in this section are based on performing exponentiation by means of repeated multiplication. In a similar way, one can perform integer multiplication by means of repeated addition. The following multiplication procedure (in which it is assumed that our language can only add, not multiply) is analogous to the expt procedure:</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">*</span></span> a b)</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> b <span class="number">0</span>)</span><br><span class="line">      <span class="number">0</span></span><br><span class="line">      (<span class="name"><span class="builtin-name">+</span></span> a (<span class="name"><span class="builtin-name">*</span></span> a (<span class="name"><span class="builtin-name">-</span></span> b <span class="number">1</span>)))))</span><br></pre></td></tr></table></figure>
<p>This algorithm takes a number of steps that is linear in $b$. Now suppose we include, together with addition, operations <code>double</code>, which doubles an integer, and <code>halve</code>, which divides an (even) integer by 2. Using these, design a multiplication procedure analogous to <code>fast-expt</code> that uses a logarithmic number of steps.</p>
</blockquote>
<p>按照题目原有的思路 $ a $ 一直变大，$b$ 一直变小直到 $0$ 为止。不过 $a$ 变大使用 <code>double</code> ，$b$ 变小使用 <code>halve</code> 。</p>
<p>还需要考虑 $ b$ 的奇偶性。</p>
<p>当 $b$ 是偶数时，$a \cdot b = double(a) \cdot halve(b)$ 。</p>
<p>当 $b$ 是奇数时，$a \cdot b = a + a \cdot ( b -1)$ 。</p>
<p>写成代码是</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">*</span></span> a b)</span><br><span class="line">	(<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> b <span class="number">0</span>)</span><br><span class="line">	    <span class="number">0</span></span><br><span class="line">	    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">even?</span></span> b)</span><br><span class="line">	        (<span class="name"><span class="builtin-name">*</span></span> (<span class="name">double</span> a) (<span class="name">halve</span> b))</span><br><span class="line">	        (<span class="name"><span class="builtin-name">+</span></span> a (<span class="name"><span class="builtin-name">*</span></span> a (<span class="name"><span class="builtin-name">-</span></span> b <span class="number">1</span>))))))</span><br></pre></td></tr></table></figure>
<h3 id="习题_1-18">习题 1.18</h3><blockquote>
<p><strong>Exercise 1.18.</strong>  Using the results of exercises <a href="#1.16">1.16</a> and <a href="#1.17">1.17</a>, devise a procedure that generates an iterative process for multiplying two integers in terms of adding, doubling, and halving and uses a logarithmic number of steps.<a href="https://mitpress.mit.edu/sicp/full-text/book/book-Z-H-11.html#footnote_Temp_68" target="_blank" rel="noopener">40</a></p>
</blockquote>
<p>将上题改成迭代式的。需要多一个变量记录累积值。</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">mul-iter</span> a b acc)</span><br><span class="line">	(<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> b <span class="number">0</span>)</span><br><span class="line">	    acc</span><br><span class="line">	    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">even?</span></span> b)</span><br><span class="line">	        (<span class="name">mul-iter</span> (<span class="name">double</span> a) (<span class="name">halve</span> b) acc)</span><br><span class="line">	        (<span class="name">mul-iter</span> a (<span class="name"><span class="builtin-name">-</span></span> b <span class="number">1</span>) (<span class="name"><span class="builtin-name">+</span></span> a acc)))))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name"><span class="builtin-name">*</span></span> a b) (<span class="name">mul-iter</span> a b <span class="number">0</span>))</span><br></pre></td></tr></table></figure>
<h3 id="习题_1-19">习题 1.19</h3><blockquote>
<p><strong>Exercise 1.19.</strong>   There is a clever algorithm for computing the Fibonacci numbers in a logarithmic number of steps. Recall the transformation of the state variables <strong>a</strong> and <strong>b</strong> in the <code>fib-iter</code> process of section <a href="https://mitpress.mit.edu/sicp/full-text/book/book-Z-H-11.html#%_sec_1.2.2" target="_blank" rel="noopener">1.2.2</a>: $ a \leftarrow a + b$  and  $b \leftarrow a$ .Call this transformation $T$, and observe that applying $T$ over and over again $n$ times, starting with $1$ and $0$, produces the pair $Fib(n+1)$ and $Fib(n)$. In other words, the Fibonacci numbers are produced by applying $T^n$, the $n$th power of the transformation $T$ , starting with the pair $(1,0)$. Now consider $T$ to be the special case of $p = 0$  and $q = 1$ in a family of transformations $T_{pq}$, where $T_{pq}$ transforms the pair $(a,b)$ according to $a \leftarrow bq + aq + ap$ and $b \leftarrow bp + aq$ . Show that if we apply such a transformation $T_{pq}$ twice, the effect is the same as using a single transformation $T_{p^{,}q^{,}}$ of the same form, and compute $p^{,}$ and $q^{,}$ in terms of $p$ and $q$. This gives us an explicit way to square these transformations, and thus we can compute $T^n$ using successive squaring, as in the fast-expt procedure. Put this all together to complete the following procedure, which runs in a logarithmic number of steps:<a href="https://mitpress.mit.edu/sicp/full-text/book/book-Z-H-11.html#footnote_Temp_70" target="_blank" rel="noopener">41</a></p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">fib</span> n)</span><br><span class="line">  (<span class="name">fib-iter</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> n))</span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">fib-iter</span> a b p q count)</span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">=</span></span> count <span class="number">0</span>) b)</span><br><span class="line">        ((<span class="name"><span class="builtin-name">even?</span></span> count)</span><br><span class="line">         (<span class="name">fib-iter</span> a</span><br><span class="line">                   b</span><br><span class="line">                   &lt;??&gt;      <span class="comment">; compute p'</span></span><br><span class="line">                   &lt;??&gt;      <span class="comment">; compute q'</span></span><br><span class="line">                   (<span class="name"><span class="builtin-name">/</span></span> count <span class="number">2</span>)))</span><br><span class="line">        (<span class="name"><span class="builtin-name">else</span></span> (<span class="name">fib-iter</span> (<span class="name"><span class="builtin-name">+</span></span> (<span class="name"><span class="builtin-name">*</span></span> b q) (<span class="name"><span class="builtin-name">*</span></span> a q) (<span class="name"><span class="builtin-name">*</span></span> a p))</span><br><span class="line">                        (<span class="name"><span class="builtin-name">+</span></span> (<span class="name"><span class="builtin-name">*</span></span> b p) (<span class="name"><span class="builtin-name">*</span></span> a q))</span><br><span class="line">                        p</span><br><span class="line">                        q</span><br><span class="line">                        (<span class="name"><span class="builtin-name">-</span></span> count <span class="number">1</span>)))))</span><br></pre></td></tr></table></figure>
</blockquote>
<p>不得不说这个算法真的很机智。线性迭代很容易想到矩阵变换，多次变化相当于矩阵的幂，通过<a href="http://www.ruanyifeng.com/blog/2015/09/matrix-multiplication.html" target="_blank" rel="noopener">矩阵乘法</a>的结合律就能一次把整个变换矩阵算出来，最后应用到 $a$ ，$b$ 的初始值就可以算出最终的值。</p>
<p>用迭代法计算 $Fib(n) = b_n$ 是这样的。</p>
<p>有一对$(a,b)$ 的初始值$(a_0,b_0)$ ，那么 $(a_1,b_1)$ 是这么得来的<br>$$<br>\begin{aligned}<br>&amp;a_1 \leftarrow  1a_0 + 1b_0 \\<br>&amp;b_1 \leftarrow 1a_0 + 0b_0<br>\end{aligned}<br>$$</p>
<p>用矩阵表示就是<br>$$<br>\begin{bmatrix}<br>1 &amp; 1 \\<br>1 &amp; 0<br>\end{bmatrix}<br>\times<br>\begin{bmatrix}<br>a_0\\b_0<br>\end{bmatrix}<br>=<br>\begin{bmatrix}<br>a_1\\b_1<br>\end{bmatrix}<br>$$<br>可以发现只要乘上左边的矩阵 $T = \begin{bmatrix}1 &amp; 1\\1 &amp; 0\end{bmatrix}$ 就可以得到下一对 $(a,b)$ </p>
<p>要求 $Fib(2)$ 的值由 $Fib(n) = b_n$ 得知只需要求 $b_2$</p>
<p>由 $b_0$ 到 $b_2$ 需要做两次变换，也就是<br>$$<br>\begin{aligned}<br>\begin{bmatrix}<br>a_2\\b_2<br>\end{bmatrix}<br>&amp;=<br>\begin{bmatrix}<br>1 &amp; 1\\<br>1 &amp; 0<br>\end{bmatrix}<br>\times<br>\begin{bmatrix}<br>a_1\\b_1<br>\end{bmatrix}<br>\\&amp;=<br>\begin{bmatrix}<br>1 &amp; 1\\<br>1 &amp; 0<br>\end{bmatrix}^2<br>\times<br>\begin{bmatrix}<br>a_0\\b_0<br>\end{bmatrix}<br>\\&amp;=<br>\begin{bmatrix}<br>2 &amp; 1\\<br>1 &amp; 1<br>\end{bmatrix}<br>\times<br>\begin{bmatrix}<br>a_0\\b_0<br>\end{bmatrix}<br>\end{aligned}<br>$$<br>由矩阵的定义得 $b_2 = 1a_0 + 1b_0 = a_0 + b_0$ 。</p>
<p>在迭代法开始时 $a = 1,b=0$ 也就是 $a_0 = 1,b_0 = 0$</p>
<p>所以 $Fib(2) = b_2 = a_0 + b_0 = 1 + 0 = 1$ 。与其他方式计算的结果相同。</p>
<p>回到题目中机智的算法，它其实是这样的</p>
<p>当 $ n $ 是偶数时，$Fib(n) = T^n b_0 = (T^2)^{n/2} b_0$ 。</p>
<p>当 $n$ 是奇数时，$Fib(n) = T \cdot T^{n-1} b_0$ </p>
<p>题目源代码丢失的部分是求偶数条件下 $p$ 和 $q$ 的值。</p>
<p>题目给出的 $(a,b)$ 递推式是<br>$$<br>\begin{aligned}<br>&amp;a_1 \leftarrow  (p+q)a_0 + qb_0 \\<br>&amp;b_1 \leftarrow qa_0 + pb_0<br>\end{aligned}<br>$$<br>用矩阵表示是<br>$$<br>\begin{bmatrix}<br>p+q &amp; q\\<br>q &amp; p<br>\end{bmatrix}<br>\times<br>\begin{bmatrix}<br>a_0\\b_0<br>\end{bmatrix}<br>=<br>\begin{bmatrix}<br>a_1\\b_1<br>\end{bmatrix}<br>$$<br>所以变换矩阵 $T = \begin{bmatrix}p+q &amp; q\\q &amp; p\end{bmatrix}$ ，那么<br>$$<br>\begin{aligned}<br>T^2 &amp;= T \cdot T<br>\\&amp;=<br>\begin{bmatrix}<br>p+q &amp; q\\<br>q &amp; p<br>\end{bmatrix}<br>\times<br>\begin{bmatrix}<br>p+q &amp; q\\<br>q &amp; p<br>\end{bmatrix}<br>\\&amp;=<br>\begin{bmatrix}<br>(p+q)^2 + q^2 &amp; q(p+q) + qp\\<br>q(p+q)+pq &amp; q^2 + p^2<br>\end{bmatrix}<br>\end{aligned}<br>$$<br>对比 $T$ 和 $T^2$ 得<br>$$<br>\begin{aligned}<br>p &amp;\leftarrow q^2 + p^2\\<br>q &amp;\leftarrow q(p+q) + pq<br>\end{aligned}<br>$$<br>所以最后答案是</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">fib-iter</span> a b p q count)</span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">=</span></span> count <span class="number">0</span>) b)</span><br><span class="line">        ((<span class="name"><span class="builtin-name">even?</span></span> count)</span><br><span class="line">         (<span class="name">fib-iter</span> a</span><br><span class="line">                   b</span><br><span class="line">                   (<span class="name"><span class="builtin-name">+</span></span> (<span class="name"><span class="builtin-name">*</span></span> q q) (<span class="name"><span class="builtin-name">*</span></span> p p))            <span class="comment">; compute p'</span></span><br><span class="line">                   (<span class="name"><span class="builtin-name">+</span></span> (<span class="name"><span class="builtin-name">*</span></span> q (<span class="name"><span class="builtin-name">+</span></span> p q)) (<span class="name"><span class="builtin-name">*</span></span> p q))      <span class="comment">; compute q'</span></span><br><span class="line">                   (<span class="name"><span class="builtin-name">/</span></span> count <span class="number">2</span>)))</span><br><span class="line">        (<span class="name"><span class="builtin-name">else</span></span> (<span class="name">fib-iter</span> (<span class="name"><span class="builtin-name">+</span></span> (<span class="name"><span class="builtin-name">*</span></span> b q) (<span class="name"><span class="builtin-name">*</span></span> a q) (<span class="name"><span class="builtin-name">*</span></span> a p))</span><br><span class="line">                        (<span class="name"><span class="builtin-name">+</span></span> (<span class="name"><span class="builtin-name">*</span></span> b p) (<span class="name"><span class="builtin-name">*</span></span> a q))</span><br><span class="line">                        p</span><br><span class="line">                        q</span><br><span class="line">                        (<span class="name"><span class="builtin-name">-</span></span> count <span class="number">1</span>)))))</span><br></pre></td></tr></table></figure>
<p>测试</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">fib</span> <span class="number">3</span>)</span><br><span class="line"><span class="comment">;; 2</span></span><br><span class="line">(<span class="name">fib</span> <span class="number">4</span>)</span><br><span class="line"><span class="comment">;; 3</span></span><br><span class="line">(<span class="name">fib</span> <span class="number">5</span>)</span><br><span class="line"><span class="comment">;; 5</span></span><br><span class="line">(<span class="name">fib</span> <span class="number">6</span>)</span><br><span class="line"><span class="comment">;; 8</span></span><br><span class="line">(<span class="name">fib</span> <span class="number">10</span>)</span><br><span class="line"><span class="comment">;; 55</span></span><br></pre></td></tr></table></figure>
<h3 id="习题_1-20">习题 1.20</h3><blockquote>
<p><strong>Exercise 1.20.</strong>  The process that a procedure generates is of course dependent on the rules used by the interpreter. As an example, consider the iterative gcd procedure given above. Suppose we were to interpret this procedure using normal-order evaluation, as discussed in section <a href="https://mitpress.mit.edu/sicp/full-text/book/book-Z-H-10.html#%_sec_1.1.5" target="_blank" rel="noopener">1.1.5</a>. (The normal-order-evaluation rule for ifis described in exercise <a href="https://mitpress.mit.edu/sicp/full-text/book/book-Z-H-10.html#%_thm_1.5" target="_blank" rel="noopener">1.5</a>.) Using the substitution method (for normal order), illustrate the process generated in evaluating <code>(gcd 206 40)</code> and indicate the remainder operations that are actually performed. How many remainderoperations are actually performed in the normal-order evaluation of <code>(gcd 206 40)</code>? In the applicative-order evaluation?</p>
</blockquote>
<p>求 normal-order 和 applicative-order 中的 <code>remainder</code> 调用次数。<code>if</code> 语句先执行判断语句，后执行条件分支。</p>
<p>按 normal-order 展开</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">gcd</span></span> <span class="number">206</span> <span class="number">40</span>)</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> <span class="number">40</span> <span class="number">0</span>)</span><br><span class="line">    <span class="number">206</span></span><br><span class="line">    (<span class="name"><span class="builtin-name">gcd</span></span> <span class="number">40</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>)))</span><br><span class="line">   </span><br><span class="line">(<span class="name"><span class="builtin-name">gcd</span></span> <span class="number">40</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>)) <span class="comment">;; gcd(40,6)</span></span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>) <span class="number">0</span>) <span class="comment">;; 先执行判断语句 remainder 调用次数 1</span></span><br><span class="line">    <span class="number">40</span></span><br><span class="line">    (<span class="name"><span class="builtin-name">gcd</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>) </span><br><span class="line">         (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">40</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>))))</span><br><span class="line">   </span><br><span class="line">(<span class="name"><span class="builtin-name">gcd</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>) </span><br><span class="line">     (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">40</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>))) <span class="comment">;; gcd(6,4)</span></span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">40</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>)) <span class="number">0</span>) <span class="comment">;; remainder 调用次数 3</span></span><br><span class="line">    (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>)</span><br><span class="line">    (<span class="name"><span class="builtin-name">gcd</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">40</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>)) </span><br><span class="line">         (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>) </span><br><span class="line">                    (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">40</span> (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name">206</span> <span class="number">40</span>))))))</span><br><span class="line"> </span><br><span class="line"> (<span class="name"><span class="builtin-name">gcd</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">40</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>)) </span><br><span class="line">      (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>) </span><br><span class="line">                 (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">40</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>)))) <span class="comment">;; gcd(4,2)</span></span><br><span class="line"> </span><br><span class="line"> (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>) </span><br><span class="line">                   (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">40</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>))) <span class="comment">;; remainder 调用次数 7</span></span><br><span class="line">        <span class="number">0</span>)</span><br><span class="line">     (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">40</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>))</span><br><span class="line">     (<span class="name"><span class="builtin-name">gcd</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>) </span><br><span class="line">                     (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">40</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>))) </span><br><span class="line">          (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">40</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>)) </span><br><span class="line">                     (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>) </span><br><span class="line">                                (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">40</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>)))))</span><br><span class="line">     </span><br><span class="line"> (<span class="name"><span class="builtin-name">gcd</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>) </span><br><span class="line">                 (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">40</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>))) </span><br><span class="line">      (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">40</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>)) </span><br><span class="line">                 (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>) </span><br><span class="line">                            (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">40</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>))))) <span class="comment">;; gcd (2,0)</span></span><br><span class="line"> </span><br><span class="line"> (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">40</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>)) <span class="comment">;; remainder 调用次数 14</span></span><br><span class="line">                   (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>) </span><br><span class="line">                              (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">40</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>)))) </span><br><span class="line">        <span class="number">0</span>)</span><br><span class="line">     (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>)</span><br><span class="line">                (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">40</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>)))</span><br><span class="line">     (<span class="name"><span class="builtin-name">gcd</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">40</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>)) </span><br><span class="line">                     (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>) </span><br><span class="line">                                (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">40</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>))))))</span><br><span class="line">    </span><br><span class="line">(<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>) (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">40</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>))) <span class="comment">;; remainder 调用次数 18</span></span><br></pre></td></tr></table></figure>
<p>按 applicative-order 展开</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">gcd</span></span> <span class="number">206</span> <span class="number">40</span>)</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">gcd</span></span> <span class="number">40</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">206</span> <span class="number">40</span>)) <span class="comment">;; remainder 调用次数 1</span></span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">gcd</span></span> <span class="number">40</span> <span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">gcd</span></span> <span class="number">6</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">40</span> <span class="number">6</span>)) <span class="comment">;; remainder 调用次数 2</span></span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">gcd</span></span> <span class="number">6</span> <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">gcd</span></span> <span class="number">4</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">6</span> <span class="number">4</span>)) <span class="comment">;; remainder 调用次数 3</span></span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">gcd</span></span> <span class="number">4</span> <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">gcd</span></span> <span class="number">2</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">4</span> <span class="number">2</span>)) <span class="comment">;; remainder 调用次数 4</span></span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">gcd</span></span> <span class="number">2</span> <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">2</span></span><br></pre></td></tr></table></figure>
<p>所以答案是 normal-order 18 次 ，applicative-order 4 次。</p>
<h3 id="习题_1-21">习题 1.21</h3><blockquote>
<p><strong>Exercise 1.21.</strong>  Use the smallest-divisor procedure to find the smallest divisor of each of the following numbers: 199, 1999, 19999.</p>
</blockquote>
<p>用 <code>smallest-divisor</code> 求 199，1999，19999 的最小约数</p>
<p>求值</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">smallest-divisor</span> <span class="number">199</span>)</span><br><span class="line"><span class="comment">;; 199</span></span><br><span class="line">(<span class="name">smallest-divisor</span> <span class="number">1999</span>)</span><br><span class="line"><span class="comment">;; 1999</span></span><br><span class="line">(<span class="name">smallest-divisor</span> <span class="number">19999</span>)</span><br><span class="line"><span class="comment">;; 7</span></span><br><span class="line"><span class="comment">;; 19999 = 7 x 2857</span></span><br></pre></td></tr></table></figure>
<h3 id="习题_1-22">习题 1.22</h3><blockquote>
<p><strong>Exercise 1.22.</strong>  Most Lisp implementations include a primitive called <code>runtime</code> that returns an integer that specifies the amount of time the system has been running (measured, for example, in microseconds). The following <code>timed-prime-test</code> procedure, when called with an integer $n$, prints $n$ and checks to see if $n$ is prime. If $n$ is prime, the procedure prints three asterisks followed by the amount of time used in performing the test.</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">timed-prime-test</span> n)</span><br><span class="line">  (<span class="name"><span class="builtin-name">newline</span></span>)</span><br><span class="line">  (<span class="name"><span class="builtin-name">display</span></span> n)</span><br><span class="line">  (<span class="name">start-prime-test</span> n (<span class="name">runtime</span>)))</span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">start-prime-test</span> n start-time)</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">prime?</span> n)</span><br><span class="line">      (<span class="name">report-prime</span> (<span class="name"><span class="builtin-name">-</span></span> (<span class="name">runtime</span>) start-time))))</span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">report-prime</span> elapsed-time)</span><br><span class="line">  (<span class="name"><span class="builtin-name">display</span></span> <span class="string">" *** "</span>)</span><br><span class="line">  (<span class="name"><span class="builtin-name">display</span></span> elapsed-time))</span><br></pre></td></tr></table></figure>
<p>Using this procedure, write a procedure <code>search-for-primes</code> that checks the primality of consecutive odd integers in a specified range. Use your procedure to find the three smallest primes larger than $1000$; larger than $10,000$; larger than $100,000$; larger than $1,000,000$. Note the time needed to test each prime. Since the testing algorithm has order of growth of $\Theta(\sqrt n)$ , you should expect that testing for primes around $10,000$ should take about $\sqrt {10}$ times as long as testing for primes around $1000$. Do your timing data bear this out? How well do the data for $100,000$ and $1,000,000$ support the $\sqrt n$  prediction? Is your result compatible with the notion that programs on your machine run in time proportional to the number of steps required for the computation?</p>
</blockquote>
<p>编写一个查找一定区间所有奇数中的函数 <code>search-for-prime</code> </p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">search-for-prime</span> begin end)</span><br><span class="line">	(<span class="name">timed-prime-test</span> begin)</span><br><span class="line">	(<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&lt;</span></span> begin end)</span><br><span class="line">	    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">even?</span></span> begin)</span><br><span class="line">	    	(<span class="name">search-for-prime</span> (<span class="name"><span class="builtin-name">+</span></span> <span class="number">1</span> begin) end)</span><br><span class="line">	    	(<span class="name">search-for-prime</span> (<span class="name"><span class="builtin-name">+</span></span> <span class="number">2</span> begin) end))))</span><br></pre></td></tr></table></figure>
<p>测试发现现在机器速度太快了。所以前后 <code>runtime</code> 差值太小总是 0 。所以改为计算总的时间。从<a href="https://www.gnu.org/software/mit-scheme/documentation/mit-scheme-ref/Machine-Time.html" target="_blank" rel="noopener">Machine-Time</a>得知尝试了几种不同的计时方式。发现 <code>real-time-clock</code> 效果较好。</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">time-for</span> n start-time)</span><br><span class="line">	(<span class="name">search-for-prime</span> n (<span class="name"><span class="builtin-name">+</span></span> n <span class="number">1000</span>))</span><br><span class="line">	(<span class="name"><span class="builtin-name">-</span></span> (<span class="name">real-time-clock</span>) start-time))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">search</span> n)</span><br><span class="line">	(<span class="name">time-for</span> n (<span class="name">real-time-clock</span>)))</span><br></pre></td></tr></table></figure>
<p>测试</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">1 ]=&gt; (search 100000) </span><br><span class="line">100003 *** 0.</span><br><span class="line">100019 *** 0.</span><br><span class="line">100043 *** 0.</span><br><span class="line">100049 *** 1.5999999999999986e-2</span><br><span class="line">100057 *** 0.</span><br><span class="line">100069 *** 0. </span><br><span class="line">...</span><br><span class="line"><span class="comment">;Value: 93 </span></span><br><span class="line">1 ]=&gt; (search 1000000) </span><br><span class="line">1000003 *** 0.</span><br><span class="line">1000033 *** 1.5000000000000013e-2</span><br><span class="line">1000037 *** 0.</span><br><span class="line">1000039 *** 0.</span><br><span class="line">1000081 *** 1.6000000000000014e-2</span><br><span class="line">1000099 *** 0. </span><br><span class="line">...</span><br><span class="line"><span class="comment">;Value: 202</span></span><br><span class="line">1 ]=&gt; (search 10000000) </span><br><span class="line">10000019 *** 1.5999999999999986e-2</span><br><span class="line">10000079 *** 1.5999999999999986e-2 </span><br><span class="line">10000103 *** 1.5999999999999986e-2 </span><br><span class="line"><span class="comment">;Value: 344</span></span><br></pre></td></tr></table></figure>
<p>每次 <code>search n</code> 的计算次数为单次计算次数乘上1000 。结果为 $1000\sqrt  n = \Theta(\sqrt n)$ 。</p>
<p>所以如果 <code>(search 1000000)</code> 耗时为 202 ，</p>
<p>那么 <code>(search 10000000)</code> 应该等于 </p>
<p>$\Theta(\sqrt {10^8}) = \Theta(\sqrt {10} \cdot \sqrt {10^7}) $<br>$= \sqrt {10} * 202 \approx 638$ 。</p>
<p>但从上面看出实际结果是 344</p>
<h3 id="习题_1-23">习题 1.23</h3><blockquote>
<p><strong>Exercise 1.23.</strong>  The smallest-divisor procedure shown at the start of this section does lots of needless testing: After it checks to see if the number is divisible by 2 there is no point in checking to see if it is divisible by any larger even numbers. This suggests that the values used for test-divisor should not be 2, 3, 4, 5, 6, …, but rather 2, 3, 5, 7, 9, …. To implement this change, define a procedure next that returns 3 if its input is equal to 2 and otherwise returns its input plus 2. Modify the smallest-divisor procedure to use (next test-divisor)instead of (+ test-divisor 1). With timed-prime-test incorporating this modified version of smallest-divisor, run the test for each of the 12 primes found in exercise <a href="https://mitpress.mit.edu/sicp/full-text/book/book-Z-H-11.html#%_thm_1.22" target="_blank" rel="noopener">1.22</a>. Since this modification halves the number of test steps, you should expect it to run about twice as fast. Is this expectation confirmed? If not, what is the observed ratio of the speeds of the two algorithms, and how do you explain the fact that it is different from 2?</p>
</blockquote>
<p>找最小约数的时候考虑了除了 2 以外的偶数，做了多余的工作。所以编写函数 <code>next</code> 返回下一个奇数。</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">next</span> x)</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> x <span class="number">2</span>)</span><br><span class="line">      <span class="number">3</span></span><br><span class="line">      (<span class="name"><span class="builtin-name">+</span></span> x <span class="number">2</span>)))</span><br></pre></td></tr></table></figure>
<p>相应的修改<code>find-divisor</code> 中的 <code>(+ test-divisor 1)</code> 为 <code>(next test-divisor)</code></p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">smallest-divisor</span> n)</span><br><span class="line">   (<span class="name">find-divisor</span> n <span class="number">2</span>))</span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">find-divisor</span> n test-divisor)</span><br><span class="line">   (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">&gt;</span></span> (<span class="name">square</span> test-divisor) n) n)</span><br><span class="line">         ((<span class="name">divides?</span> test-divisor n) test-divisor)</span><br><span class="line">         (<span class="name"><span class="builtin-name">else</span></span> (<span class="name">find-divisor</span> n (<span class="name">next</span> test-divisor)))))</span><br></pre></td></tr></table></figure>
<p>测试时间</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">search</span> <span class="number">100000</span>)</span><br><span class="line"><span class="comment">;Value: 78</span></span><br><span class="line">(<span class="name">search</span> <span class="number">1000000</span>)</span><br><span class="line"><span class="comment">;Value: 125 之前是 202</span></span><br><span class="line">(<span class="name">search</span> <span class="number">10000000</span>)</span><br><span class="line"><span class="comment">;Value: 296 之前是 344</span></span><br></pre></td></tr></table></figure>
<p>$10^6$ 的时间为之前的 1.6 倍，而 $10^7$ 为之前的 1.1 倍。</p>
<h3 id="习题_1-24">习题 1.24</h3><blockquote>
<p><strong>Exercise 1.24.</strong>  Modify the timed-prime-test procedure of exercise <a href="https://mitpress.mit.edu/sicp/full-text/book/book-Z-H-11.html#%_thm_1.22" target="_blank" rel="noopener">1.22</a> to use fast-prime? (the Fermat method), and test each of the 12 primes you found in that exercise. Since the Fermat test has $\Theta(\log n)$ growth, how would you expect the time to test primes near 1,000,000 to compare with the time needed to test primes near 1000? Do your data bear this out? Can you explain any discrepancy you find?</p>
</blockquote>
<p>将 <code>prime?</code> 改为 <code>fast-prime?</code> </p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">timed-prime-test</span> n)</span><br><span class="line">  (<span class="name"><span class="builtin-name">newline</span></span>)</span><br><span class="line">  (<span class="name"><span class="builtin-name">display</span></span> n)</span><br><span class="line">  (<span class="name">start-prime-test</span> n (<span class="name">system-clock</span>)))</span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">start-prime-test</span> n start-time)</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">fast-prime?</span> n <span class="number">1000</span>)</span><br><span class="line">      (<span class="name">report-prime</span> (<span class="name"><span class="builtin-name">-</span></span> (<span class="name">system-clock</span>) start-time))))</span><br><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">report-prime</span> elapsed-time)</span><br><span class="line">  (<span class="name"><span class="builtin-name">display</span></span> <span class="string">" *** "</span>)</span><br><span class="line">  (<span class="name"><span class="builtin-name">display</span></span> elapsed-time))</span><br></pre></td></tr></table></figure>
<p>$1000$ 太小了。分别选择 $10^5$ ，$10^6$ 和 $10^7$ 附近的质数进行测试</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">timed-prime-test</span> <span class="number">100003</span>)</span><br><span class="line"><span class="comment">; 100003 *** 63</span></span><br><span class="line">(<span class="name">timed-prime-test</span> <span class="number">1000003</span>)</span><br><span class="line"><span class="comment">; 1000003 *** 78</span></span><br><span class="line">(<span class="name">timed-prime-test</span> <span class="number">10000019</span>)</span><br><span class="line"><span class="comment">; 10000019 *** 94</span></span><br></pre></td></tr></table></figure>
<p>$10^6$ 的复杂度是<br>$\Theta(\log_2{10^6}) = \Theta(\log_2{10^5 \cdot 10})$<br>$= \Theta(\log_2{10}) + \Theta(\log_2{10^5})$ </p>
<p>$\Theta(\log_2{10^5}) $ 也就是 $10^5$ 的时间 $63$</p>
<p>所以 $\Theta(\log_2{10}) = \Theta(\log_2{10^6}) - \Theta(\log_2{10^5}) $<br>$= 78 - 63 = 15$ 。</p>
<p>类似地，$\Theta(\log_2{10^7}) = \Theta(\log_2{10^6}) + \Theta(\log_2{10}) $<br>$= 78 + 15 = 93$ 。</p>
<p>跟实际时间 $94$ 非常接近。</p>
<h3 id="习题_1-25">习题 1.25</h3><blockquote>
<p><strong>Exercise 1.25.</strong>  Alyssa P. Hacker complains that we went to a lot of extra work in writing <code>expmod</code>. After all, she says, since we already know how to compute exponentials, we could have simply written</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">expmod</span> base exp m)</span><br><span class="line">  (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name">fast-expt</span> base exp) m))</span><br></pre></td></tr></table></figure>
<p>Is she correct? Would this procedure serve as well for our fast prime tester? Explain.</p>
</blockquote>
<p>看起来没有什么问题。随便测试了几个也没问题。既然是用了不同的方式，肯定有区别。</p>
<p>先看原来的求值过程</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">expmod</span> <span class="number">5</span> <span class="number">2</span> <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name">square</span> (<span class="name">expmode</span> <span class="number">5</span> <span class="number">1</span> <span class="number">4</span>)) <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name">square</span> (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">*</span></span> <span class="number">5</span> (<span class="name">expmod</span> <span class="number">5</span> <span class="number">0</span> <span class="number">4</span>)) <span class="number">4</span>)) <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name">square</span> (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">*</span></span> <span class="number">5</span> <span class="number">1</span>) <span class="number">4</span>)) <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name">square</span> (<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">15</span> <span class="number">4</span>)) <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name">square</span> <span class="number">3</span>) <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">remainder</span></span> <span class="number">9</span> <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>对比本题中的 <code>(expmod 5 2 4) = (remainder 25 4)</code> </p>
<p>发现书中的不是直接求余，而是先把数字减小后求余。这样的好处是当防止在数字比较大的情况下整数溢出。</p>
<h3 id="习题_1-26">习题 1.26</h3><blockquote>
<p><strong>Exercise 1.26.</strong>  Louis Reasoner is having great difficulty doing exercise <a href="https://mitpress.mit.edu/sicp/full-text/book/book-Z-H-11.html#%_thm_1.24" target="_blank" rel="noopener">1.24</a>. His <code>fast-prime?</code> test seems to run more slowly than his <code>prime?</code> test. Louis calls his friend Eva Lu Ator over to help. When they examine Louis’s code, they find that he has rewritten the <code>expmod</code> procedure to use an explicit multiplication, rather than calling <code>square</code>:</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">expmod</span> base exp m)</span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> ((<span class="name"><span class="builtin-name">=</span></span> exp <span class="number">0</span>) <span class="number">1</span>)</span><br><span class="line">        ((<span class="name"><span class="builtin-name">even?</span></span> exp)</span><br><span class="line">         (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">*</span></span> (<span class="name">expmod</span> base (<span class="name"><span class="builtin-name">/</span></span> exp <span class="number">2</span>) m)</span><br><span class="line">                       (<span class="name">expmod</span> base (<span class="name"><span class="builtin-name">/</span></span> exp <span class="number">2</span>) m))</span><br><span class="line">                    m))</span><br><span class="line">        (<span class="name"><span class="builtin-name">else</span></span></span><br><span class="line">         (<span class="name"><span class="builtin-name">remainder</span></span> (<span class="name"><span class="builtin-name">*</span></span> base (<span class="name">expmod</span> base (<span class="name"><span class="builtin-name">-</span></span> exp <span class="number">1</span>) m))</span><br><span class="line">                    m))))</span><br></pre></td></tr></table></figure>
<p>“I don’t see what difference that could make,’’ says Louis. “I do.” says Eva. “By writing the procedure like that, you have transformed the $\Theta(\log n)$ process into a $\Theta(n)$ process.’’ Explain.</p>
</blockquote>
<p>这种情形有点类似 applicative-order 和 normal-order 的区别。</p>
<p>例如 <code>(square (+ 1 1))</code> 和 <code>(* (+ 1 1) (+ 1 1))</code> 计算过程</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">square</span> (<span class="name"><span class="builtin-name">+</span></span> <span class="number">1</span> <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">(<span class="name">square</span> <span class="number">2</span>) <span class="comment">;; (+ 1 1) 只被计算了一次</span></span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">*</span></span> <span class="number">2</span> <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">4</span></span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">*</span></span> (<span class="name"><span class="builtin-name">+</span></span> <span class="number">1</span> <span class="number">1</span>) (<span class="name"><span class="builtin-name">+</span></span> <span class="number">1</span> <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">*</span></span> <span class="number">2</span> (<span class="name"><span class="builtin-name">+</span></span> <span class="number">1</span> <span class="number">1</span>)) <span class="comment">;; 第一次计算 (+ 1 1)</span></span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">*</span></span> <span class="number">2</span> <span class="number">2</span>) <span class="comment">;; 第二次计算 (+ 1 1)</span></span><br><span class="line"></span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure>
<p>所以不用 <code>square</code> 的情况下会多计算一次。</p>
<p>如果像题目中这种需要计算的式子是递归的，那么相当于每次都多计算了一次。</p>
<p>原来只需要计算 $\log_2{n}$ 次。</p>
<p>现在需要每次都计算两次。求值展开的形状相当于二叉树，叶子数量就是计算次数。</p>
<p>叶子数量等于 2 的树高次方。树高为 $\log_2{n}$ 。所以叶子数量为 $2^h = 2^{\log_2{n}} = n$ 。</p>
<p>所以复杂度为 $\Theta(n)$  。</p>
<h3 id="习题_1-27">习题 1.27</h3><blockquote>
<p><strong>Exercise 1.27.</strong>  Demonstrate that the Carmichael numbers listed in footnote <a href="https://mitpress.mit.edu/sicp/full-text/book/book-Z-H-11.html#footnote_Temp_80" target="_blank" rel="noopener">47</a> really do fool the Fermat test. That is, write a procedure that takes an integer $n$ and tests whether $a^n$ is congruent to <strong>a</strong> modulo $n$ for every $a&lt;n$, and try your procedure on the given Carmichael numbers.</p>
</blockquote>
<p>编写函数对 $n$ 用所有小于 $n$ 的数进行费马测试。</p>
<p>首先编写一次费马测试的函数。</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">one-fermat-test</span> n a)</span><br><span class="line">    (<span class="name"><span class="builtin-name">=</span></span> (<span class="name">expmod</span> a n n) a))</span><br></pre></td></tr></table></figure>
<p>其次编写对所有小于 $n$ 的数进行费马测试的函数 <code>(test n a)</code> </p>
<p>当 $ a \le 2$ 时，无论 $n$ 是多少直接通过费马测验。</p>
<p>当 $ a &gt; 2$ 时，$test (n,a) = one-fermat-test(n,a) \wedge test(n,a-1)$ </p>
<p>写成代码</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">test-all</span> n a)</span><br><span class="line">	(<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&lt;=</span></span> a <span class="number">2</span>)</span><br><span class="line">	    <span class="literal">#t</span></span><br><span class="line">	    (<span class="name"><span class="builtin-name">and</span></span> (<span class="name">one-fermat-test</span> n a) (<span class="name">test-all</span> n (<span class="name"><span class="builtin-name">-</span></span> a <span class="number">1</span>)))))</span><br></pre></td></tr></table></figure>
<p>费马测试</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">fermat-test</span> n)</span><br><span class="line">	(<span class="name">test-all</span> n (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">1</span>)))</span><br></pre></td></tr></table></figure>
<p>测试</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">fermat-test</span> <span class="number">3</span>)</span><br><span class="line"><span class="comment">;; #t</span></span><br><span class="line">(<span class="name">fermat-test</span> <span class="number">5</span>)</span><br><span class="line"><span class="comment">;; #t</span></span><br><span class="line">(<span class="name">fermat-test</span> <span class="number">561</span>)</span><br><span class="line"><span class="comment">;; #t</span></span><br><span class="line">(<span class="name">fermat-test</span> <span class="number">1105</span>)</span><br><span class="line"><span class="comment">;; #t</span></span><br></pre></td></tr></table></figure>
<p>果然 561 和 1105 把费马测试给耍了。</p>
<h3 id="习题_1-28">习题 1.28</h3><blockquote>
<p><strong>Exercise 1.28.</strong>  One variant of the Fermat test that cannot be fooled is called the <em>Miller-Rabin test</em> (Miller 1976; Rabin 1980). This starts from an alternate form of Fermat’s Little Theorem, which states that if $n$ is a prime number and $a$ is any positive integer less than $n$, then $a$ raised to the $(n - 1)$st power is congruent to 1 modulo $n$. To test the primality of a number $n$ by the Miller-Rabin test, we pick a random number $a&lt;n$ and raise $a$ to the $(n - 1)$st power modulo $n$ using the <code>expmod</code> procedure. However, whenever we perform the squaring step in <code>expmod</code>, we check to see if we have discovered a “nontrivial square root of 1 modulo $n$, that is, a number not equal to 1 or $n$ - 1 whose square is equal to 1 modulo $n$. It is possible to prove that if such a nontrivial square root of 1 exists, then $n$ is not prime. It is also possible to prove that if $n$ is an odd number that is not prime, then, for at least half the numbers $a&lt;n$, computing $a^{n-1}$ in this way will reveal a nontrivial square root of 1 modulo $n$. (This is why the Miller-Rabin test cannot be fooled.) Modify the <code>expmod</code> procedure to signal if it discovers a nontrivial square root of 1, and use this to implement the Miller-Rabin test with a procedure analogous to fermat-test. Check your procedure by testing various known primes and non-primes. Hint: One convenient way to make <code>expmod</code> signal is to have it return 0.</p>
</blockquote>
<p>如果米勒测试的非平凡平方根 $number \in (1,n-1)$ ，那么对于非素数的奇数 $9$ 有</p>
<p>$2^2 \equiv 4 \pmod {9} $</p>
<p>$3^2 \equiv 0 \pmod 9$</p>
<p>$4^2 \equiv 7 \pmod 9$</p>
<p>$5^2 \equiv 7 \pmod 9$</p>
<p>$6^2 \equiv 0 \pmod 9$</p>
<p>$7^2 \equiv 4 \pmod 9$</p>
<p>显然没有任何一个数满足 $ number^2 \equiv 1 \pmod 9$ 。但是题目中说到对于非素数的奇数至少有一半小于 $n$ 的数 $a$ 在计算$a^{n-1} \bmod n$ 的过程中可以找到非平凡平方根。</p>
<p>那么把条件改为非平凡平方根不一定小于 $n$ ，那么对于质数 $13$ 在计算 $10^{12} \bmod 13$ 过程中发现 </p>
<p>$10^6 = (10^3)^2 \equiv 1 \pmod {13}$</p>
<p>也就是存在非平凡平方根 $10^3$ ，使得 $13$ 没有通过米勒测试。但是 $13$ 是质数。 </p>
<p>后来找 Miller-Rabin 测试的相关资料。发现了一篇文章。恍然大悟。原来是计算过程不是这样的。觉得写不出更好的。所以答案请看<a href="http://blog.rainy.im/2015/08/27/miller-rabin-n-rsa/" target="_blank" rel="noopener">这篇文章</a>。</p>
<h2 id="总结">总结</h2><p>这一小节主要讲述了解决问题的两种方式，递归和迭代。分别介绍了它们的特点。同时引入算法复杂度的衡量方法，目的是为了督促读者写出更好的解决方法。</p>
<p>这一小节有不少习题还挺难的。花了很多时间才多完。自以为编程老司机结果才第二小节就翻车了（逃</p>
</div></article></div></main><footer><div class="paginator"><a href="/Promise/" class="prev">PREV</a><a href="/BrainFuck/" class="next">NEXT</a></div><div class="copyright"><p>© 2014 - 2018 <a href="http://en.ors-sro.com">拖鞋党</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p><p>Hosted by <a href="https://pages.coding.me" style="font-weight: bold; animation: breathe 3s infinite">Coding Pages</a></p></div></footer></div><script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {
    inlineMath: [ ['$','$'], ["\\\(","\\)"] ],
    processEscapes: true
    }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});
</script></body></html>